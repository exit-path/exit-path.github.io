(self.webpackChunk_exit_path_game=self.webpackChunk_exit_path_game||[]).push([[785],{3720:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,s=new Array(e);r<e;r++)s[r]=t[r];return s}},9822:t=>{t.exports=function(t){if(Array.isArray(t))return t}},8239:t=>{t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},8616:t=>{t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],s=!0,n=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(r.push(o.value),!e||r.length!==e);s=!0);}catch(t){n=!0,i=t}finally{try{s||null==a.return||a.return()}finally{if(n)throw i}}return r}}},533:t=>{t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},6739:(t,e,r)=>{var s=r(9822),n=r(8616),i=r(7698),o=r(533);t.exports=function(t,e){return s(t)||n(t,e)||i(t,e)||o()}},7698:(t,e,r)=>{var s=r(3720);t.exports=function(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}},107:(t,e,r)=>{t.exports=r(2390)},5034:()=>{},5350:(t,e,r)=>{"use strict";r.d(e,{j:()=>N,U:()=>O});var s=r(2738),n=r(2120),i=r(6300),o=r(3855),a=r(3441),l=r(2389),h=r(2829);class u{constructor(t,e){this.id=t,this.image=e}}class c{constructor(t,e){this.id=t,this.audio=e}}var d,f,_=r(2526),m=r(1645);!function(t){t[t.Pad=0]="Pad"}(d||(d={})),function(t){t[t.SolidColor=0]="SolidColor",t[t.LinearGradient=1]="LinearGradient",t[t.RadicalGradient=2]="RadicalGradient",t[t.ClippedBitmap=3]="ClippedBitmap"}(f||(f={}));var p=r(8671),g=r(5355);function b(t,e){const r=new Float32Array(t.vertices).map((t=>t/20)),s=new Uint16Array(t.indices);let n=1/0,i=1/0,o=-1/0,a=-1/0;for(let e=0;e<t.vertices.length;e+=2){const t=r[e+0],s=r[e+1];n=Math.min(n,t),i=Math.min(i,s),o=Math.max(o,t),a=Math.max(a,s)}const l=p.J.fromValues(n,i,o-n,a-i);let h=null,u=4294967295;const c=_.yR(_.Ue());switch(t.fill.kind){case f.SolidColor:u=(0,g.u_)(t.fill.color);break;case f.LinearGradient:case f.RadicalGradient:const r=`${(d=t.fill.gradient).mode};${d.points.map((([t,e])=>`${t}:${e}`)).join(";")}`;h=e.gradientCache.get(r),h||(h=function(t){const e=document.createElement("canvas");e.width=256,e.height=256;const r=e.getContext("2d"),s=r.createLinearGradient(0,0,e.width,0);for(const[e,r]of t.points){const t=r>>>24&255,n=r>>>16&255,i=r>>>8&255,o=r>>>0&255;s.addColorStop(e/255,`rgba(${n}, ${i}, ${o}, ${t/255})`)}return r.fillStyle=s,r.fillRect(0,0,e.width,e.height),e}(t.fill.gradient),e.gradientCache.set(r,h)),_.t8(c,...t.fill.matrix),v(c,32768,32768,.5);break;case f.ClippedBitmap:h=e.resolveImage(t.fill.characterId),_.t8(c,...t.fill.matrix),v(c,h.width,h.height,0)}var d;const b=new Uint32Array(r.length/2);return b.fill(u),new m.r("shape",r,b,s,c,h,t.fill.kind,l)}function v(t,e,r,s){_.U_(t,t),_.bA(t,t,[20/e,20/r]),t[4]=t[4]/e+s,t[5]=t[5]/r+s}class y{constructor(t,e,r){this.id=t,this.renderObjects=e.contours.map((t=>b(t,r))),this.bounds=p.J.create();for(const t of this.renderObjects)p.J.union(this.bounds,this.bounds,t.bounds)}applyTo(t){t.__node.setRenderObjects(this.renderObjects,this.bounds)}}class x{constructor(t,e,r){this.id=t,this.frames=new Map;for(const[t,s]of e.frames){const e=s.contours.map((t=>b(t,r))),n=p.J.create();for(const t of e)p.J.union(n,n,t.bounds);this.frames.set(t,{renderObjects:e,bounds:n})}}applyTo(t){const e=this.frames.get(t.__ratio);e?t.__node.setRenderObjects(e.renderObjects,e.bounds):console.warn(`no ratio frame #${t.__ratio} for morph shape #${this.id}`)}}var T=r(5950),E=r(843);class w{constructor(t,e,r){this.id=t,this.library=r,this.numFrames=e.numFrames,this.frames=e.frames}applyTo(t,e,r){const s=new Map,n=[],i=t=>{const e=this.frames.find((e=>e.frame===t));if(e){n.length=0;for(const t of e.actions){if(t.kind===T.z.StartSound){n.push(t);continue}const e=s.get(t.depth);e&&e.kind===t.kind?e.kind===T.z.PlaceObject&&s.set(t.depth,{...e,...t}):s.set(t.depth,t)}}};if(r>=e)for(let t=e;t<=r;t++)i(t);else{for(const e of t.__children)e.__depth>=0&&s.set(e.__depth,{kind:T.z.RemoveObject,depth:e.__depth});for(let t=1;t<=r;t++)i(t)}for(const e of s.values())switch(e.kind){case T.z.PlaceObject:(0,E.WO)(this.library,t,e);break;case T.z.RemoveObject:(0,E.Ff)(t,e)}for(const e of n)(0,E.jf)(this.library,t.__soundContext,e);(0,E.PU)(t)}}class R{constructor(t,e,r){this.id=t,this.font=e,this.charMap=new Map,this.glyphs=e.glyphs.map((t=>{const e=t.shape.contours.map((t=>b(t,r)));return{renderObjects:m.r.merge("text",e.map((t=>({renderObject:t,transform:_.yR(_.Ue())}))))}}));for(let t=0;t<e.glyphs.length;t++){const r=e.glyphs[t].char;r&&this.charMap.set(r,t)}this.layout=e.layout&&{ascent:e.layout.ascent/20/1024,descent:e.layout.descent/20/1024,leading:e.layout.ascent/20/1024,advances:e.layout.advances.map((t=>t/20/1024))}}}class M{constructor(t,e,r){this.id=t,this.renderObjects=[],this.bounds=p.J.scale(p.J.create(),p.J.fromValues(...e.bounds),.05);const s=_.al(...e.matrix);s[4]/=20,s[5]/=20;const n=[];for(const t of e.glyphs){const e=r.resolveFont(t.fontId).glyphs[t.index],i=_.Ue();_.Iu(i,s,[t.x/20,t.y/20]),_.bA(i,i,[t.size/1024/20,t.size/1024/20]);const o=(0,g.u_)(t.color);for(const t of e.renderObjects)n.push({renderObject:t,color:o,transform:i})}this.renderObjects=m.r.merge("text",n)}applyTo(t){t.__node.setRenderObjects(this.renderObjects,this.bounds)}}class A{constructor(t,e,r){this.id=t,this.lib=r,this.def={...e,fontHeight:e.fontHeight&&e.fontHeight/20,leftMargin:e.leftMargin&&e.leftMargin/20,rightMargin:e.rightMargin&&e.rightMargin/20,indent:e.indent&&e.indent/20,leading:e.leading&&e.leading/20},this.layoutBounds=p.J.scale(p.J.create(),p.J.fromValues(...e.bounds),.05)}applyTo(t){var e,r;switch(t.wordWrap=this.def.isWordWrap,t.multiline=this.def.isMultiline,t.type=this.def.isReadonly?l.TextFieldType.DYNAMIC:l.TextFieldType.INPUT,t.selectable=!this.def.noSelect,p.J.copy(t.__container.layoutBounds,this.layoutBounds),this.def.align){case 0:t.defaultTextFormat.align=l.TextFormatAlign.LEFT;break;case 1:t.defaultTextFormat.align=l.TextFormatAlign.RIGHT;break;case 2:t.defaultTextFormat.align=l.TextFormatAlign.CENTER;break;case 3:t.defaultTextFormat.align=l.TextFormatAlign.JUSTIFY}null!=this.def.textColor&&(t.defaultTextFormat.color=this.def.textColor),null!=this.def.fontID&&(t.defaultTextFormat.font=this.lib.resolveFont(this.def.fontID).font.name),null!=this.def.fontHeight&&(t.defaultTextFormat.size=this.def.fontHeight),null!=this.def.leading&&(t.defaultTextFormat.leading=this.def.leading),this.def.isHTML?t.htmlText=null!==(e=this.def.initialText)&&void 0!==e?e:"":t.text=null!==(r=this.def.initialText)&&void 0!==r?r:""}}var F=r(2166),S=r(6217),L=r(7381),B=r(5351),C=r(6375);async function D(t,e,r){r(0,e);const s=(await fetch(t)).body.getReader(),n=[];let i=0;for(;;){const t=await s.read();if(t.done)break;n.push(t.value),i+=t.value.length,r(i,e)}const o=new Uint8Array(i);let a=0;for(const t of n)o.set(t,a),a+=t.length;return r(i,i),o}async function O(t,e){const r=new Map;for(const[e,{size:s}]of Object.entries(t.assets))r.set(e,[0,s]);const s=t=>(s,n)=>{r.set(t,[s,n]);let i=0,o=0;for(const[t,e]of r.values())i+=t,o+=e;null==e||e(i/o)},n=t.assets[t.data],i=await D(n.url.toString(),n.size,s(t.data)),o=JSON.parse((new TextDecoder).decode(i)),a=new N(t.properties);await Promise.all([...Array.from(Object.entries(o.images)).map((async([e,{id:r}])=>{const n=t.assets[r],i=await new Promise(((t,e)=>{const i=s(r);i(0,n.size);let o=0;const a=new Image;a.onload=()=>{i(o,o),t(a)},a.onerror=t=>e(t),a.onprogress=t=>{o=t.loaded,i(o,n.size)},a.src=n.url.toString()}));a.images.set(Number(e),new u(Number(e),i))})),...Array.from(Object.entries(o.sounds)).map((async([e,{id:r}])=>{const n=t.assets[r],i=await D(n.url.toString(),n.size,s(r)),o=await C.B.decodeAudioData(i.buffer);a.sounds.set(Number(e),new c(Number(e),o))}))]);for(const[t,e]of Object.entries(o.shapes)){const r=Number(t);a.shapes.set(r,new y(r,e,a))}for(const[t,e]of Object.entries(o.morphShapes)){const r=Number(t),s=new x(r,e,a);a.morphShapes.set(r,s)}for(const[t,e]of Object.entries(o.sprites)){const r=Number(t);a.sprites.set(r,new w(r,e,a))}for(const[t,e]of Object.entries(o.fonts)){const r=Number(t),s=new R(r,e,a);a.fonts.set(r,s),S.t.instance.registerFont(s)}for(const[t,e]of Object.entries(o.staticTexts)){const r=Number(t),s=new M(r,e,a);a.staticTexts.set(r,s)}for(const[t,e]of Object.entries(o.editTexts)){const r=Number(t),s=new A(r,e,a);a.editTexts.set(r,s)}for(const[t,e]of Object.entries(o.buttons)){const r=Number(t),s=new F.p(r,e,a);a.buttons.set(r,s)}for(const[t,e]of Object.entries(o.linkages)){const r=B.Z.instance.classes.get(e);if(!r)throw new Error(`Linked class ${e} not found`);const s=Number(t);a.linkedClasses.set(s,r)}return a.linkCharacters(),a}class N{constructor(t){this.properties=t,this.images=new Map,this.sounds=new Map,this.shapes=new Map,this.morphShapes=new Map,this.sprites=new Map,this.fonts=new Map,this.staticTexts=new Map,this.editTexts=new Map,this.buttons=new Map,this.linkedClasses=new Map,this.gradientCache=new Map}resolveImage(t){const e=this.images.get(t);if(!e)throw new Error(`Image character #${t} not found`);return e.image}resolveFont(t){const e=this.fonts.get(t);if(!e)throw new Error(`Font character #${t} not found`);return e}linkCharacters(){const t=(t,e)=>{for(const[r,s]of t){let t=this.linkedClasses.get(r);if(!t){const n="Character"+r;t=class extends(e(s)){},Object.defineProperty(t,"name",{value:n}),this.linkedClasses.set(r,t)}Object.assign(t,{__character:s})}};t(this.sounds,(()=>h.Sound)),t(this.shapes,(()=>s.b)),t(this.morphShapes,(()=>n.W)),t(this.sprites,(t=>t.numFrames>1?o.K:i.j)),t(this.staticTexts,(()=>a.V)),t(this.editTexts,(()=>l.TextField)),t(this.buttons,(()=>L.SimpleButton))}instantiateCharacter(t){const e=this.linkedClasses.get(t);if(!e)throw new Error(`Character ${t} not found`);return new e}}},5351:(t,e,r)=>{"use strict";r.d(e,{Z:()=>s});class s{constructor(){this.classes=new Map}addClassRoot(t){const e=(t,r)=>{for(const[s,n]of Object.entries(r)){const r=""===t?s:`${t}.${s}`;"function"==typeof n?this.classes.set(r,n):"object"==typeof n&&e(r,n)}};e("",t)}}s.instance=new s},6217:(t,e,r)=>{"use strict";r.d(e,{t:()=>s});class s{constructor(){this.fonts=new Map}registerFont(t){const e=this.fonts.get(t.font.name)||[];e.push(t),this.fonts.set(t.font.name,e)}resolve(t,e,r){const s=this.fonts.get(t)||[];for(const t of s)if(t.font.isItalic===e&&t.font.isBold===r)return t;return null}}s.instance=new s},1455:()=>{},5030:()=>{},7964:(t,e,r)=>{"use strict";r.d(e,{i:()=>n});const s=new Map;class n{constructor(){let t=Reflect.getPrototypeOf(this),e=s.get(t);if(!e){const r=new Map;for(;t&&t!==n.prototype;){for(const e of Reflect.ownKeys(t)){if(r.has(e))continue;const s=Reflect.getOwnPropertyDescriptor(t,e);s&&"function"==typeof s.value&&r.set(e,s.value)}t=Reflect.getPrototypeOf(t)}r.delete("constructor"),e=Array.from(r.entries()),s.set(Reflect.getPrototypeOf(this),e)}for(const[t,r]of e)this[t]=r.bind(this);this.__preInit()}__preInit(){}}},3919:(t,e,r)=>{"use strict";r.r(e),r.d(e,{AVMObject:()=>o.i,Class:()=>i,Runtime:()=>s,XML:()=>n});class s{static trace(...t){console.log(...t)}static uint(t){return(0|t)>>>0}static int(t){return 0|t}static isInterface(t,e){return e.__IMPL in t}}class n{}const i=Function;var o=r(7964)},3349:()=>{},489:(t,e,r)=>{"use strict";var s;r.d(e,{P:()=>s}),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"}(s||(s={}))},4539:()=>{},6305:()=>{},5400:()=>{},4834:()=>{},214:()=>{},5950:(t,e,r)=>{"use strict";var s;r.d(e,{z:()=>s}),function(t){t[t.PlaceObject=0]="PlaceObject",t[t.RemoveObject=1]="RemoveObject",t[t.StartSound=2]="StartSound"}(s||(s={}))},2573:()=>{},8454:(t,e,r)=>{"use strict";r.r(e),r.d(e,{FrameActionKind:()=>l.z,TextAlign:()=>c.P});var s=r(6305),n={};for(const t in s)"default"!==t&&(n[t]=()=>s[t]);r.d(e,n);var i=r(214);n={};for(const t in i)"default"!==t&&(n[t]=()=>i[t]);r.d(e,n);var o=r(4834);n={};for(const t in o)"default"!==t&&(n[t]=()=>o[t]);r.d(e,n);var a=r(5400);n={};for(const t in a)"default"!==t&&(n[t]=()=>a[t]);r.d(e,n);var l=r(5950),h=r(4539);n={};for(const t in h)["default","FrameActionKind"].indexOf(t)<0&&(n[t]=()=>h[t]);r.d(e,n);var u=r(2573);n={};for(const t in u)["default","FrameActionKind"].indexOf(t)<0&&(n[t]=()=>u[t]);r.d(e,n);var c=r(489),d=r(3349);n={};for(const t in d)["default","FrameActionKind","TextAlign"].indexOf(t)<0&&(n[t]=()=>d[t]);r.d(e,n)},94:(t,e,r)=>{"use strict";r.r(e),r.d(e,{character:()=>s,text:()=>n,avm2:()=>i,AssetLibrary:()=>o.j,loadManifest:()=>o.U,FontRegistry:()=>c.t,ClassRegistry:()=>d.Z});var s=r(8454),n=r(1759),i=r(3919),o=r(5350),a=r(5030),l={};for(const t in a)["default","character","text","avm2","AssetLibrary","loadManifest"].indexOf(t)<0&&(l[t]=()=>a[t]);r.d(e,l);var h=r(5034);l={};for(const t in h)["default","character","text","avm2","AssetLibrary","loadManifest"].indexOf(t)<0&&(l[t]=()=>h[t]);r.d(e,l);var u=r(1455);l={};for(const t in u)["default","character","text","avm2","AssetLibrary","loadManifest"].indexOf(t)<0&&(l[t]=()=>u[t]);r.d(e,l);var c=r(6217),d=r(5351)},9956:(t,e,r)=>{"use strict";r.d(e,{W:()=>l});var s=r(7264),n=r(2389),i=r(4674),o=r(8671);const a=new DOMParser;class l{constructor(t){this.node=t,this.segments=[],this.htmlRoot=a.parseFromString("<root />","text/xml").documentElement,this.defaultTextFormat=new s.S,this.wordWrap=!1,this.multiline=!1,this.layoutBounds=o.J.create(),this.__text="",this.__htmlText=""}get text(){return this.__text}set text(t){this.__text!==t&&(this.htmlRoot.textContent=t,this.parseHTML())}get htmlText(){return this.__htmlText}set htmlText(t){if(this.__htmlText!==t){try{this.htmlRoot.innerHTML=t}catch(t){}this.parseHTML()}}parseHTML(){var t;const e=this.htmlRoot.ownerDocument.createTreeWalker(this.htmlRoot,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);let r={format:this.defaultTextFormat.__clone(),text:""};const s=[r],i=[],o=t=>{const e=r.format.__clone();let o="";switch(t.tagName.toLowerCase()){case"b":e.bold=!0;break;case"br":o="\n";break;case"font":for(let r=0;r<t.attributes.length;r++){const s=t.attributes[r];switch(s.name.toLowerCase()){case"color":/^#[0-9a-fA-F]{6}$/.test(s.value)&&(e.color=parseInt(s.value.slice(1),16)+4278190080);break;case"face":e.font=s.value;break;case"size":/^\d+$/.test(s.value)&&(e.size=Number(s.value))}}break;case"i":e.italic=!0;break;case"p":for(let r=0;r<t.attributes.length;r++){const s=t.attributes[r];switch(s.name.toLowerCase()){case"align":switch(s.value){case"left":e.align=n.TextFormatAlign.LEFT;break;case"right":e.align=n.TextFormatAlign.RIGHT;break;case"justify":e.align=n.TextFormatAlign.JUSTIFY;break;case"center":e.align=n.TextFormatAlign.CENTER}}break}}r={format:e,text:o},s.push(r),i.push(r)},a=t=>{s.pop(),r=s[s.length-1]};let l=e.root;for(;l;){let t;if(l instanceof Text?(h=l,r.text+=h.textContent):l instanceof Element&&o(l),t=e.firstChild())l=t;else if(t=e.nextSibling())l=t;else{for(;(t=e.parentNode())&&(t instanceof Element&&a(),!(t=e.nextSibling())););!t&&l instanceof Element&&a(),l=t}}var h;this.segments=i.filter((t=>t.text.length>0)),this.__text=null!==(t=this.htmlRoot.textContent)&&void 0!==t?t:"",this.__htmlText=this.htmlRoot.innerHTML,this.layout()}layout(){const t=(0,i.b)(this.segments,this.layoutBounds,this.wordWrap,this.multiline);this.node.setRenderObjects(t.renderObjects,this.layoutBounds)}}},1271:()=>{},1759:(t,e,r)=>{"use strict";r.r(e),r.d(e,{Container:()=>s.W,layout:()=>o.b});var s=r(9956),n=r(1271),i={};for(const t in n)["default","Container"].indexOf(t)<0&&(i[t]=()=>n[t]);r.d(e,i);var o=r(4674)},4674:(t,e,r)=>{"use strict";r.d(e,{b:()=>u});var s=r(5543),n=r(2526),i=r(2389),o=r(1645),a=r(5355),l=r(8671),h=r(6217);function u(t,e,r,s){const n=function(t,e,r,s){let n={glyphs:[],width:0};const i=[n];for(const{format:o,text:a}of t)for(const t of a){if(s&&"\n"===t){n={glyphs:[],width:0},i.push(n);continue}const a=f(o,t),l=a.advance;r&&n.width+l>e[2]&&(n={glyphs:[],width:0},i.push(n)),n.glyphs.push(a),n.width+=l}return i}(t,e,r,s),i=l.J.create(),o=[];let a=0;for(const t of n){const r=_(t,a,e);o.push(...r.renderObjects),l.J.union(i,i,r.bounds),a+=r.bounds[3]}return{bounds:i,renderObjects:o}}function c(t){return Math.min(127,t.size)}function d(t){return{renderObjects:[],color:t.color,align:t.align,size:c(t),leading:t.leading,advance:c(t),ascent:c(t),descent:0}}function f(t,e){var r,s,n,i,o,a;const l=h.t.instance.resolve(t.font,t.italic,t.bold);if(!l)return d(t);const u=l.charMap.get(e);return null==u?d(t):{renderObjects:l.glyphs[u].renderObjects,color:t.color,align:t.align,size:c(t),leading:t.leading,advance:(null!==(s=null===(r=l.layout)||void 0===r?void 0:r.advances[u])&&void 0!==s?s:0)*c(t),ascent:null!==(i=null===(n=l.layout)||void 0===n?void 0:n.ascent)&&void 0!==i?i:0,descent:null!==(a=null===(o=l.layout)||void 0===o?void 0:o.descent)&&void 0!==a?a:0}}function _(t,e,r){if(0===t.glyphs.length)return{bounds:l.J.create(),renderObjects:[]};const h=r[0]+2,u=r[2]-4;let c,d;switch(t.glyphs[0].align){case i.TextFormatAlign.RIGHT:c=0,d=h+u-t.width;break;case i.TextFormatAlign.CENTER:c=0,d=h+(u-t.width)/2;break;case i.TextFormatAlign.JUSTIFY:c=t.glyphs.length>0?h+(u-t.width)/(t.glyphs.length-1):0,d=0;break;default:c=0,d=h}const f=[];let _=0,m=0;for(const e of t.glyphs)_=Math.max(_,e.ascent*e.size);for(const e of t.glyphs)m=Math.max(m,_+e.descent*e.size+e.leading);s.Ue();for(const r of t.glyphs){const t=n.Ue();n.vc(t,[d,e+_]),n.bA(t,t,[r.size/1024,r.size/1024]);const s=(0,a.u_)(r.color);for(const e of r.renderObjects)f.push({renderObject:e,color:s,transform:t});d+=r.advance+c}return{bounds:l.J.fromValues(0,e,d,e+m),renderObjects:o.r.merge("text",f)}}},2640:(t,e,r)=>{"use strict";r.d(e,{s:()=>f});var s=r(5543),n=r(2526),i=r(8671),o=r(570),a=r(8281),l=r(8745),h=r(7069),u=r(230);i.J.create();const c=s.Ue();let d=null;class f extends o.p{constructor(){const t=d;d=null,super(),null==t||t.fn(this)}static __initChar(t,e){return d={fn:e},t()}__preInit(){this.__character=null,this.__depth=-1,this.__clipDepth=-1,this.__parent=null,this.name="",this.__mask=null,this.__maskRefs=0,this.__filters=[],this.__node=new u.B(this),this.transform=new l.w,this.transform.__setNode(this.__node),super.__preInit()}get visible(){return this.__node.visible}set visible(t){this.__node.visible=t}get parent(){return this.__parent}set parent(t){const e=this.stage;this.__parent=t;const r=this.stage;r!==e&&(r?(r.__displayListDirty=!0,this.__onAddedToStage(r)):e&&this.__onRemovedFromStage(e)),this.__setEventParent(this.parent)}get stage(){var t,e;return null!==(e=null===(t=this.parent)||void 0===t?void 0:t.stage)&&void 0!==e?e:null}get mask(){return this.__mask}set mask(t){var e;this.__mask&&(this.__mask.__maskRefs--,this.__mask.__node.isMask=this.__mask.__maskRefs>0),this.__mask=t,this.__node.mask=null!==(e=null==t?void 0:t.__node)&&void 0!==e?e:null,this.__node.markRenderDirty(),this.__mask&&(this.__mask.__maskRefs++,this.__mask.__node.isMask=this.__mask.__maskRefs>0)}get filters(){return this.__filters}set filters(t){this.__filters=t,this.__node.filters=t.map((t=>t.__filter)).filter((t=>t.filter.isEffective(t))),this.__node.markRenderDirty()}get cacheAsBitmap(){return this.__node.cacheAsBitmap||this.__node.filters.length>0}set cacheAsBitmap(t){this.__node.cacheAsBitmap=t}get x(){return this.__node.transformLocal[4]}set x(t){t=(0,u.V)(t),this.__node.transformLocal[4]!==t&&(this.__node.transformLocal[4]=t,this.__node.markLayoutDirty())}get y(){return this.__node.transformLocal[5]}set y(t){t=(0,u.V)(t),this.__node.transformLocal[5]!==t&&(this.__node.transformLocal[5]=t,this.__node.markLayoutDirty())}get scaleX(){return this.__node.transformLocal[0]}set scaleX(t){this.__node.transformLocal[0]!==t&&(this.__node.transformLocal[0]=t,this.__node.markLayoutDirty())}get scaleY(){return this.__node.transformLocal[3]}set scaleY(t){this.__node.transformLocal[3]!==t&&(this.__node.transformLocal[3]=t,this.__node.markLayoutDirty())}get rotation(){return 180*Math.atan2(this.__node.transformLocal[1],this.__node.transformLocal[3])/Math.PI}set rotation(t){const e=(t-this.rotation)/180*Math.PI;0!==e&&(n.U1(this.__node.transformLocal,this.__node.transformLocal,e),this.__node.markLayoutDirty())}get width(){return this.__node.ensureLayout(),Math.abs(this.__node.boundsLocal[2]*this.__node.transformLocal[0])}set width(t){this.__node.ensureLayout();let e=0===this.__node.boundsLocal[2]?1:t/this.__node.boundsLocal[2];0!==this.__node.transformLocal[0]&&(e*=Math.sign(this.__node.transformLocal[0])),this.__node.transformLocal[0]!==e&&(this.__node.transformLocal[0]=e,this.__node.markLayoutDirty())}get height(){return this.__node.ensureLayout(),this.__node.boundsLocal[3]*this.__node.transformLocal[3]}set height(t){this.__node.ensureLayout();let e=0===this.__node.boundsLocal[3]?1:t/this.__node.boundsLocal[3];0!==this.__node.transformLocal[3]&&(e*=Math.sign(this.__node.transformLocal[3])),this.__node.transformLocal[3]!==e&&(this.__node.transformLocal[3]=e,this.__node.markLayoutDirty())}get mouseX(){const t=this.stage;return t?(this.__globalToLocal(c,t.__mousePosition,!0),c[0]):0}get mouseY(){const t=this.stage;return t?(this.__globalToLocal(c,t.__mousePosition,!0),c[1]):0}__globalToLocal(t,e,r){r&&this.__node.ensureLayout(),s.iu(t,e,this.__node.transformWorldInvert)}globalToLocal(t){const e=new h.E;return this.__globalToLocal(e.__value,t.__value,!0),e}hitTestPoint(t,e,r=!1){return!!this.visible&&(this.__node.ensureLayout(),s.t8(c,t,e),this.__node.hitTest(c,r))}hitTestObject(t){return this.__node.ensureLayout(),t.__node.ensureLayout(),i.J.intersects(t.__node.boundsWorld,this.__node.boundsWorld)}__initFrame(t){}__onRender(){}__onAddedToStage(t){this.dispatchEvent(new a.j(a.j.ADDED_TO_STAGE,!1,!1))}__onRemovedFromStage(t){this.dispatchEvent(new a.j(a.j.REMOVED_FROM_STAGE,!1,!1))}}},581:(t,e,r)=>{"use strict";r.d(e,{_:()=>n});var s=r(8077);class n extends s.D{__preInit(){this.__children=[],super.__preInit()}get numChildren(){return this.__children.length}addChild(t){var e;return null===(e=t.parent)||void 0===e||e.removeChild(t),this.__children.push(t),t.parent=this,t.__node.setParent(this.__node,this.__node.children.length),t}addChildAt(t,e){var r;return null===(r=t.parent)||void 0===r||r.removeChild(t),this.__children.splice(e,0,t),t.parent=this,t.__node.setParent(this.__node,e),t}getChildByName(t){var e;return null!==(e=this.__children.find((e=>e.name===t)))&&void 0!==e?e:null}getChildAt(t){var e;return null!==(e=this.__children[t])&&void 0!==e?e:null}removeChild(t){const e=this.__children.indexOf(t);return e<0?null:(this.__children.splice(e,1),t.parent=null,t.__node.setParent(null,0),t)}removeChildAt(t){var e;const r=null!==(e=this.__children.splice(t,1)[0])&&void 0!==e?e:null;return r&&(r.parent=null,r.__node.setParent(null,0)),r}removeChildren(t=0,e=this.__children.length){const r=this.__children.splice(t,e-t);for(const t of r)t.parent=null,t.__node.setParent(null,0)}contains(t){return this.__children.includes(t)}__onAddedToStage(t){for(const e of this.__children)e.__onAddedToStage(t);super.__onAddedToStage(t)}__onRemovedFromStage(t){super.__onRemovedFromStage(t);for(const e of this.__children)e.__onRemovedFromStage(t)}__onRender(){super.__onRender();for(const t of this.__children)t.__onRender()}}},9838:(t,e,r)=>{"use strict";r.d(e,{T:()=>a});var s=r(7964),n=r(5355),i=r(1645),o=r(8671);class a extends s.i{constructor(t){super(),this.__node=t,this.__x=0,this.__y=0,this.__lineThickness=-1,this.__lineColor=4278190080,this.__bounds=o.J.create(),this.__renderObjects=[]}clear(){this.__x=0,this.__y=0,this.__lineThickness=-1,this.__lineColor=4278190080,o.J.clear(this.__bounds),this.__renderObjects.length=0,this.__node.setRenderObjects([],this.__bounds)}lineStyle(t=NaN,e=0,r=1){this.__lineThickness=isNaN(t)?-1:t,this.__lineColor=(0,n.u_)(e+16777216*Math.floor(255*r))}moveTo(t,e){this.__x=t,this.__y=e}lineTo(t,e){const r=i.r.line(this.__x,this.__y,t,e,this.__lineThickness,this.__lineColor);this.__renderObjects.push(r),o.J.union(this.__bounds,this.__bounds,r.bounds),this.__node.setRenderObjects(this.__renderObjects.slice(),this.__bounds),this.__x=t,this.__y=e}}},8077:(t,e,r)=>{"use strict";r.d(e,{D:()=>n});var s=r(2640);class n extends s.s{constructor(){super(),this.tabEnabled=!1,this.tabIndex=-1}get __isPointerCursor(){return!!this.parent&&this.parent.__isPointerCursor}}},2120:(t,e,r)=>{"use strict";r.d(e,{W:()=>n});var s=r(2640);class n extends s.s{constructor(){var t,e;super(),this.___ratio=0,this.__character=null!==(t=this.constructor.__character)&&void 0!==t?t:null,null===(e=this.__character)||void 0===e||e.applyTo(this)}get __ratio(){return this.___ratio}set __ratio(t){var e;this.___ratio=t,null===(e=this.__character)||void 0===e||e.applyTo(this)}}},3855:(t,e,r)=>{"use strict";r.d(e,{K:()=>i});var s=r(6300),n=r(8433);class i extends s.j{constructor(){super(),this.__lastFrame=1,this.__constructed=!1,this.__frameScripts=new Map,this.__scriptFrame=0,this.currentFrame=1,this.isPlaying=!0}get totalFrames(){var t,e;return null!==(e=null===(t=this.__character)||void 0===t?void 0:t.numFrames)&&void 0!==e?e:1}__initFrame(t){if(super.__initFrame(t),this.isPlaying&&this.__constructed){let e=this.currentFrame+1;(e>this.totalFrames||e<1)&&(e=1),this.currentFrame!==e&&(this.currentFrame=e,t.__constructionQueue.push(this))}else this.__constructed||t.__constructionQueue.push(this)}__constructFrame(){var t;this.__lastFrame!==this.currentFrame&&(null===(t=this.__character)||void 0===t||t.applyTo(this,this.__lastFrame,this.currentFrame),this.__lastFrame=this.currentFrame),this.__constructed=!0,this.__scriptFrame!==this.currentFrame&&(0,n.s)((()=>this.__runFrameScript()))}__runFrameScript(){if(this.__scriptFrame!==this.currentFrame){this.__scriptFrame=this.currentFrame;const t=this.__frameScripts.get(this.__scriptFrame);null==t||t()}}addFrameScript(...t){for(let e=0;e<t.length;e+=2)this.__frameScripts.set(t[e]+1,t[e+1])}__resolveFrame(t){var e,r;const s=Number(t);if(!isNaN(s))return s;const n=null===(r=null===(e=this.__character)||void 0===e?void 0:e.frames)||void 0===r?void 0:r.find((e=>e.label===t));return n?n.frame:null}gotoAndPlay(t){const e=this.__resolveFrame(t);e&&(this.currentFrame=e),this.isPlaying=!0;const r=this.stage;r?(r.__constructionQueue.push(this),(0,n.E)(!1,r)):(this.__constructFrame(),this.__runFrameScript())}gotoAndStop(t){const e=this.__resolveFrame(t);e&&(this.currentFrame=e),this.isPlaying=!1;const r=this.stage;r?(r.__constructionQueue.push(this),(0,n.E)(!1,r)):(this.__constructFrame(),this.__runFrameScript())}play(){this.isPlaying=!0}stop(){this.isPlaying=!1}__onAddedToStage(t){super.__onAddedToStage(t),t.__constructionQueue.push(this)}}},2738:(t,e,r)=>{"use strict";r.d(e,{b:()=>i});var s=r(2640),n=r(9838);class i extends s.s{constructor(){var t,e;super(),this.graphics=new n.T(this.__node),this.__character=null!==(t=this.constructor.__character)&&void 0!==t?t:null,null===(e=this.__character)||void 0===e||e.applyTo(this)}}},6300:(t,e,r)=>{"use strict";r.d(e,{j:()=>o});var s=r(581),n=r(9838),i=r(1719);class o extends s._{constructor(){super(),this.buttonMode=!1,this.graphics=new n.T(this.__node)}__preInit(){var t,e;super.__preInit(),this.__soundContext=new i.$,this.__character=null!==(t=this.constructor.__character)&&void 0!==t?t:null,null===(e=this.__character)||void 0===e||e.applyTo(this,1,1)}get __isPointerCursor(){return this.buttonMode||super.__isPointerCursor}}},8433:(t,e,r)=>{"use strict";r.d(e,{s:()=>o,E:()=>a});var s=r(8281),n=r(570);const i=[];function o(t){i.push(t)}function a(t,e){if(t){e.__ensureDisplayList();for(const t of e.__displayList.slice())t.__initFrame(e);n.$.dispatchEvent(new s.j(s.j.ENTER_FRAME,!1,!1))}for(;e.__constructionQueue.length>0;){const t=e.__constructionQueue.slice();e.__constructionQueue.length=0;for(const e of t)e.__constructFrame()}const r=i.slice();i.length=0;for(const t of r)t()}},7381:(t,e,r)=>{"use strict";r.r(e),r.d(e,{Bitmap:()=>at,BitmapData:()=>ot,DisplayObject:()=>n.s,DisplayObjectContainer:()=>i._,InteractiveObject:()=>o.D,Loader:()=>lt,MorphShape:()=>l.W,MovieClip:()=>u.K,Shape:()=>a.b,SimpleButton:()=>rt,Sprite:()=>h.j,Stage:()=>z});var s,n=r(2640),i=r(581),o=r(8077),a=r(2738),l=r(2120),h=r(6300),u=r(3855),c=r(5543),d=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class f{constructor(t,e){this.width=t,this.height=e,this.container=document.createElement("div"),this.element=document.createElement("canvas"),s.set(this,""),this.container.style.setProperty("width",t+"px"),this.container.style.setProperty("height",e+"px"),this.container.style.setProperty("position","relative"),this.element.tabIndex=0,this.element.style.setProperty("outline","none","important"),this.element.style.setProperty("position","absolute"),this.element.style.setProperty("width",t+"px"),this.element.style.setProperty("height",e+"px"),this.element.width=t*window.devicePixelRatio,this.element.height=e*window.devicePixelRatio,this.container.appendChild(this.element)}get cursor(){return d(this,s)}set cursor(t){t!==d(this,s)&&(this.element.style.cursor=t,function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");e.set(t,r)}(this,s,t))}resolveCoords(t,e,r){const s=this.element.getBoundingClientRect();t[0]=e-s.left,t[1]=r-s.top}}s=new WeakMap;var _=r(2526),m=r(4945),p=r(8671),g=r(5355);const b=m.al(1,1,1,1),v=m.al(0,0,0,0);class y{constructor(t){this.renders=[],this.transformStack=[],this.allTransforms=[],this.transformStack.push({view:_.yR(_.Ue()),colorMul:m.t8(m.Ue(),1,1,1,1),colorAdd:m.t8(m.Ue(),0,0,0,0),renderMask:null,useMask:[]}),this.allTransforms.push(this.transformStack[0]),this.viewport=t}get transform(){return this.transformStack[this.transformStack.length-1]}set transform(t){this.transformStack[this.transformStack.length-1]=t}get bounds(){const t=p.J.create(),e=p.J.create();for(const r of this.renders)"object"in r?p.J.apply(e,r.object.bounds,r.transform.view):"texture"in r?(p.J.copy(e,r.texture.bounds),e[0]-=r.texture.paddings[0],e[1]-=r.texture.paddings[1],e[2]+=2*r.texture.paddings[0],e[3]+=2*r.texture.paddings[1],p.J.apply(e,e,r.transform.view)):"filter"in r&&p.J.apply(e,r.filter.bounds,r.transform.view),p.J.union(t,t,e);return t}pushTransform(t,e){var r,s,n;const i=this.transformStack[this.transformStack.length-1],o={view:_.Ue(),colorAdd:m.Ue(),colorMul:m.Ue(),renderMask:null!==(r=null==e?void 0:e.renderMask)&&void 0!==r?r:i.renderMask,useMask:i.useMask.slice()};_.Jp(o.view,i.view,t),(0,g.fE)(o.colorMul,o.colorAdd,i.colorMul,i.colorAdd,null!==(s=null==e?void 0:e.colorMul)&&void 0!==s?s:b,null!==(n=null==e?void 0:e.colorAdd)&&void 0!==n?n:v),(null==e?void 0:e.useMask)&&o.useMask.push(e.useMask),this.transformStack.push(o),this.allTransforms.push(o)}dupTransform(){const t=this.transform,e={view:_.d9(t.view),colorAdd:m.d9(t.colorAdd),colorMul:m.d9(t.colorMul),renderMask:t.renderMask,useMask:t.useMask.slice()};this.transformStack.push(e),this.allTransforms.push(e)}popTransform(){this.transformStack.pop()}renderContext(t){const{view:e,colorMul:r,colorAdd:s}=this.transform;for(const n of t.allTransforms)_.Jp(n.view,e,n.view),(0,g.fE)(n.colorMul,n.colorAdd,r,s,n.colorMul,n.colorAdd),this.allTransforms.push(n);this.renders.push(...t.renders)}renderObject(t){this.renders.push({transform:this.transform,object:t})}renderCache(t,e,r,s){const n=_.U_(_.Ue(),r);_.Jp(n,n,this.transform.view),this.renders.push({transform:this.transform,cache:{view:n,texture:t,bounds:e,then:s}})}renderTexture(t,e,r,s){this.dupTransform();const n=this.transform.view;_.Iu(n,n,[t[0],t[1]]);const i=c.al(Math.abs(n[0]),Math.abs(n[3]));0!==i[0]&&0!==i[1]&&_.bA(n,n,[1/i[0],1/i[1]]),_.Iu(n,n,[-e[0],-e[1]]);const o=c.al(n[4],n[5]);n[4]=Math.floor(n[4]),n[5]=Math.floor(n[5]),this.renders.push({transform:this.transform,texture:{bounds:p.J.copy(p.J.create(),t),paddings:e,scale:i,translate:o,fn:r,then:s}}),this.popTransform()}renderFilter(t,e,r,s){this.renders.push({transform:this.transform,filter:{texture:t,bounds:e,instance:r,then:s}})}}class x{constructor(){this.listeners=[]}subscribe(t){this.listeners.push({disabled:!1,handler:t})}unsubscribe(t){for(const e of this.listeners)e.handler===t&&(e.disabled=!0);this.listeners=this.listeners.filter((t=>!t.disabled))}emit(...t){for(const{disabled:e,handler:r}of this.listeners)e||r(...t)}}class T{constructor(t,e){this.canvas=t,this.attrs=e,this.contextLost=new x,this.resetRender=new x,this.maxTextures=1,this.textureLimit=16,this.maxSamples=0,this.sampleLimit=4,this.clearColor=m.al(NaN,NaN,NaN,NaN),this.viewport=m.al(NaN,NaN,NaN,NaN),this.bindings=new Map,this.textureUnits=new Map,this.activeTexture=NaN,this.vertexArray=null,this.program=null,this.capacity=NaN,this.blendEquation=[NaN,NaN],this.blendFuncs=[NaN,NaN,NaN,NaN];const r=t.getContext("webgl2",e);if(!r)throw new Error("Cannot create WebGL2 context");this.gl=r,t.addEventListener("webglcontextlost",(t=>{t.preventDefault(),this.contextLost.emit()}),!1),t.addEventListener("webglcontextrestored",(t=>{t.preventDefault(),this.reset()}),!1),this.reset()}reset(){this.maxTextures=Math.min(this.textureLimit,this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)),this.maxSamples=Math.min(this.sampleLimit,this.gl.getParameter(this.gl.MAX_SAMPLES)),m.t8(this.clearColor,NaN,NaN,NaN,NaN),m.t8(this.viewport,NaN,NaN,NaN,NaN),this.bindings.clear(),this.textureUnits.clear(),this.activeTexture=NaN,this.vertexArray=null,this.program=null,this.capacity=NaN,this.blendEquation.fill(NaN),this.blendFuncs.fill(NaN)}resetRenderState(){this.reset(),this.resetRender.emit()}bindTexture(t,e){this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.textureUnits.set(t,e)}bindTextures(t){return t.map(((t,e)=>(this.bindTexture(e,t),e)))}bindBuffer(t,e){this.bindings.get(t)!==e&&(this.gl.bindBuffer(t,e),this.bindings.set(t,e))}bindVertexArray(t){this.vertexArray!==t&&(this.gl.bindVertexArray(t),this.vertexArray=t,this.bindings.clear())}bindRenderbuffer(t,e){this.bindings.get(t)!==e&&(this.gl.bindRenderbuffer(t,e),this.bindings.set(t,e))}bindFramebuffer(t,e){this.bindings.get(t)!==e&&(this.gl.bindFramebuffer(t,e),this.bindings.set(t,e),t===this.gl.FRAMEBUFFER?(this.bindings.set(this.gl.FRAMEBUFFER,e),this.bindings.set(this.gl.READ_FRAMEBUFFER,e),this.bindings.set(this.gl.DRAW_FRAMEBUFFER,e)):t===this.gl.READ_FRAMEBUFFER?(this.bindings.set(this.gl.FRAMEBUFFER,void 0),this.bindings.set(this.gl.READ_FRAMEBUFFER,e)):t===this.gl.DRAW_FRAMEBUFFER&&(this.bindings.set(this.gl.FRAMEBUFFER,void 0),this.bindings.set(this.gl.DRAW_FRAMEBUFFER,e)))}useProgram(t){this.program!==t&&(this.gl.useProgram(t),this.program=t)}setActiveTexture(t){this.activeTexture!==t&&(this.gl.activeTexture(t),this.activeTexture=t)}setClearColor(t,e,r,s){m.fS(this.clearColor,[t,e,r,s])||(this.gl.clearColor(t,e,r,s),m.t8(this.clearColor,t,e,r,s))}setViewport(t,e,r,s){m.fS(this.viewport,[t,e,r,s])||(this.gl.viewport(t,e,r,s),m.t8(this.viewport,t,e,r,s))}enable(t){(this.capacity|t)!==this.capacity&&(this.gl.enable(t),this.capacity|=t)}disable(t){(this.capacity&~t)!==this.capacity&&(this.gl.disable(t),this.capacity&=~t)}setBlendEquation(t,e=t){this.blendEquation[0]===t&&this.blendEquation[1]===e||(this.gl.blendEquationSeparate(t,e),this.blendEquation[0]=t,this.blendEquation[1]=e)}setBlendFunc(t,e,r=t,s=e){this.blendFuncs[0]===t&&this.blendFuncs[1]===e&&this.blendFuncs[2]===r&&this.blendFuncs[3]===s||(this.gl.blendFuncSeparate(t,e,r,s),this.blendFuncs[0]=t,this.blendFuncs[1]=e,this.blendFuncs[2]=r,this.blendFuncs[3]=s)}}var E=r(1552),w=r(970),R=r(7527),M=r(2106);class A{constructor(t,e,r){this.type=r,this.state=null,this.renderbuffer=null,this.onContextLost=()=>{this.state&&(this.state.contextLost.unsubscribe(this.onContextLost),this.state.resetRender.unsubscribe(this.onResetRender),this.state=null),this.renderbuffer=null},this.onResetRender=()=>{this.delete()},this.width=t,this.height=e}ensure(t){if(this.renderbuffer)return;const e=t.gl;let r;switch(this.type){case"depth":r=e.DEPTH_COMPONENT16;break;case"rgba":r=e.RGBA8;break;case"rgb":r=e.RGB8}const s=e.createRenderbuffer();t.bindRenderbuffer(e.RENDERBUFFER,s),t.maxSamples>0?e.renderbufferStorageMultisample(e.RENDERBUFFER,t.maxSamples,r,this.width,this.height):e.renderbufferStorage(e.RENDERBUFFER,r,this.width,this.height),this.state=t,this.renderbuffer=s,t.contextLost.subscribe(this.onContextLost),t.resetRender.subscribe(this.onResetRender)}delete(){this.state&&(this.state.gl.deleteRenderbuffer(this.renderbuffer),this.state.contextLost.unsubscribe(this.onContextLost),this.state.resetRender.unsubscribe(this.onResetRender),this.state=null,this.renderbuffer=null)}}class F{constructor(t){this.state=null,this.framebuffer=null,this.onContextLost=()=>{this.state&&(this.state.contextLost.unsubscribe(this.onContextLost),this.state.resetRender.unsubscribe(this.onResetRender),this.state=null),this.framebuffer=null},this.onResetRender=()=>{this.delete()},this.colorAttachment=t}ensure(t){if(this.framebuffer)return;const e=t.gl;this.colorAttachment.ensure(t);const r=e.createFramebuffer();t.bindFramebuffer(e.DRAW_FRAMEBUFFER,r),this.colorAttachment instanceof E.x?e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.colorAttachment.texture,0):e.framebufferRenderbuffer(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,this.colorAttachment.renderbuffer),this.state=t,this.framebuffer=r,t.contextLost.subscribe(this.onContextLost),t.resetRender.subscribe(this.onResetRender)}delete(){this.state&&(this.state.gl.deleteFramebuffer(this.framebuffer),this.state.contextLost.unsubscribe(this.onContextLost),this.state.resetRender.unsubscribe(this.onResetRender),this.state=null,this.framebuffer=null)}}class S{constructor(){this.texturePool=new Map,this.renderbufferPool=new Map}takeTexture(t,e){const r=`${t}:${e}`,s=this.texturePool.get(r)||[];if(0===s.length){const r=E.x.size(t,e),n=new F(r);s.push({insertAt:+new Date,item:{texture:r,framebuffer:n}})}return s.pop().item}takeRenderbuffer(t,e){const r=`${t}:${e}`,s=this.renderbufferPool.get(r)||[];if(0===s.length){const r=new A(t,e,"rgba"),n=new F(r);s.push({insertAt:+new Date,item:{renderbuffer:r,framebuffer:n}})}return s.pop().item}returnTexture(t){const e=`${t.texture.width}:${t.texture.height}`,r=this.texturePool.get(e)||[];r.push({insertAt:+new Date,item:t}),this.texturePool.set(e,r)}returnRenderbuffer(t){const e=`${t.renderbuffer.width}:${t.renderbuffer.height}`,r=this.renderbufferPool.get(e)||[];r.push({insertAt:+new Date,item:t}),this.renderbufferPool.set(e,r)}cleanLRU(){const t=+new Date-6e4;for(const[e,r]of this.renderbufferPool){const s=r.filter((e=>e.insertAt<t));for(const{item:t}of s)t.renderbuffer.delete(),t.framebuffer.delete();this.renderbufferPool.set(e,r.filter((t=>!s.includes(t))))}for(const[e,r]of this.texturePool){const s=r.filter((e=>e.insertAt<t));for(const{item:t}of s)t.texture.delete(),t.framebuffer.delete();this.texturePool.set(e,r.filter((t=>!s.includes(t))))}}}class L{constructor(t,e){this.width=t,this.height=e,this.x=0,this.y=0,this.rowHeight=0}add(t,e){let r=this.x,s=this.y;return this.x+t>this.width&&(this.x=0,this.y+=this.rowHeight+1,this.rowHeight=0,r=this.x,s=this.y),this.x+=t,this.x>this.width?null:(this.x+=1,this.rowHeight=Math.max(this.rowHeight,e),this.y+this.rowHeight>this.height?null:p.J.fromValues(r,s,t,e))}}var B=r(2550),C=r(1645);class D{constructor(t,e,r,s){this.pool=t,this.target=e,this.view=r,this.bounds=s,this.returned=!1,this.renderObject=C.r.rect(s,e.texture)}return(){this.returned||(this.pool.returnTexture(this.target),this.returned=!0)}}const O=524288,N=1024,U=p.J.create();function k(t){return t<128?128:t<256?256:t<512?512:t<1024?1024:Math.ceil(t)}_.Ue();class P{constructor(t){var e;this.canvas=t,this.textureMap=new Map,this.renderPool=new S,this.textureReturnBox=[],this.renderbufferReturnBox=[],this.indexData=new Uint16Array(O),this.attributeData=new ArrayBuffer(3670016),this.indices=w.l.index(this.indexData,"STREAM_DRAW"),this.attributes=w.l.vertex(new Uint32Array(this.attributeData),"STREAM_DRAW"),this.attrFloat=new Float32Array(this.attributeData,0),this.attrUint=new Uint32Array(this.attributeData,0),this.renderVertexArray=new M.F([{index:0,buffer:this.attributes,type:"float",components:4,offset:0,stride:56},{index:1,buffer:this.attributes,type:"byte",components:4,normalized:!0,offset:16,stride:56},{index:2,buffer:this.attributes,type:"float",components:4,offset:20,stride:56},{index:3,buffer:this.attributes,type:"float",components:4,offset:36,stride:56},{index:4,buffer:this.attributes,type:"byte",components:4,integer:!0,offset:52,stride:56}],this.indices),this.backgroundColor=0,this.glState=new T(t.element,{alpha:!1,premultipliedAlpha:!1,antialias:!1}),this.renderProgram=new R.$("\n#version 300 es\n\nlayout(location=0) in vec4 aVertex;\nlayout(location=1) in vec4 aColor;\nlayout(location=2) in vec4 aColorMul;\nlayout(location=3) in vec4 aColorAdd;\nlayout(location=4) in uvec4 aMode;\n\nout vec2 vTextureCoords;\nout vec4 vColor;\nout vec4 vColorMul;\nout vec4 vColorAdd;\nflat out uvec4 vMode;\n\nvoid main(void) {\n    vec2 pos = aVertex.xy;\n    vec2 uv = aVertex.zw;\n    gl_Position = vec4(pos, 0.0, 1.0);\n\n    vTextureCoords = uv;\n    vColor = aColor;\n    vColorMul = aColorMul;\n    vColorAdd = aColorAdd;\n    vMode = aMode;\n}\n",`\n#version 300 es\nprecision highp float;\n\nin vec2 vTextureCoords;\nin vec4 vColor;\nin vec4 vColorMul;\nin vec4 vColorAdd;\nflat in uvec4 vMode;\nout vec4 fragColor;\n\nuniform sampler2D uTextures[${e=this.glState.maxTextures}];\n\nvec4 sampleTex(int id, vec2 coords) {\n  vec4 color;\n  ${new Array(e).fill(0).map(((t,e)=>`\n      if (id == ${e}) {\n        color = texture(uTextures[${e}], coords);\n      }\n      `)).join("\n")}\n  return color;\n}\n\nvec4 getTexel(int id, ivec2 coords) {\n  vec4 color;\n  ${new Array(e).fill(0).map(((t,e)=>`\n      if (id == ${e}) {\n        color = texelFetch(uTextures[${e}], coords, 0);\n      }\n      `)).join("\n")}\n  return color;\n}\n\nvoid main(void) {\n    int fillMode = int(vMode.x) % 4;\n    int texId = int(vMode.x) / 4;\n    int maskMode = int(vMode.y) % 4;\n    int maskTexId = int(vMode.y) / 4;\n    int maskID = int(vMode.z);\n\n    vec2 coords;\n    if (fillMode == 1) {\n        coords = vec2(vTextureCoords.x, 0.0);\n    } else if (fillMode == 2) {\n        coords = vec2(length(vTextureCoords * 2.0 - 1.0), 0.0);\n    } else {\n        coords = vTextureCoords;\n    }\n\n    vec4 tex = sampleTex(texId, coords);\n    vec4 color = (tex * vColor * vec4(vColorMul.rgb, 1.0)) * vColorMul.a;\n    color += vColorAdd * color.a;\n\n    if (maskMode == 1) {\n      color = vec4(float(maskID) / 255.0, 0.0, 0.0, 1.0);\n    } else if (maskMode == 2) {\n      vec4 mask = getTexel(maskTexId, ivec2(gl_FragCoord.xy));\n      if (maskID == int(mask.r * 255.0)) {\n        color = color * mask.a;\n      } else {\n        color = vec4(0.0);\n      }\n    }\n\n    color = trunc(color * 255.0) / 255.0;\n    fragColor = color;\n}\n`),this.textureUnits=new Int32Array(this.glState.maxTextures),this.renderProgram.ensure(this.glState),this.renderVertexArray.ensure(this.glState),this.defaultFramebuffer=new F(new A(t.element.width,t.element.height,"rgb"))}renderFrame(t){const e=this.glState.gl,{width:r,height:s}=this.canvas;this.renderNode(t,this.defaultFramebuffer,r,s,(()=>{this.glState.setClearColor((this.backgroundColor>>>16&255)/255,(this.backgroundColor>>>8&255)/255,(this.backgroundColor>>>0&255)/255,1),e.clear(e.COLOR_BUFFER_BIT)}))}blitFrame(){if(this.glState.gl.isContextLost())return;const{width:t,height:e}=this.defaultFramebuffer.colorAttachment,r=this.glState.gl;this.defaultFramebuffer.ensure(this.glState),this.glState.bindFramebuffer(r.READ_FRAMEBUFFER,this.defaultFramebuffer.framebuffer),this.glState.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),r.blitFramebuffer(0,0,t,e,0,0,t,e,r.COLOR_BUFFER_BIT,r.NEAREST)}renderNode(t,e,r,s,n){if(this.glState.gl.isContextLost())return;const{width:i,height:o}=e.colorAttachment,a=p.J.fromValues(0,0,i,o),l=new y(a);t.render(l);const h=(0,B.C)(_.Ue(),r,s,!0);this.textureReturnBox.length=0,this.renderbufferReturnBox.length=0;try{this.render(l.renders,e,h,n)}finally{for(const t of this.textureReturnBox)this.renderPool.returnTexture(t);for(const t of this.renderbufferReturnBox)this.renderPool.returnRenderbuffer(t);this.renderPool.cleanLRU()}}loadTexture(t){if(t instanceof E.x)return t;let e=this.textureMap.get(t);return e||(e=t?E.x.image(t):E.x.WHITE,this.textureMap.set(t,e)),e}render(t,e,r,s){const n=[],i=[],o=[],a=t=>{n.length=0,i.length=0,o.length=0;for(const e of t)"texture"in e?n.push(e):"filter"in e?i.push(e):"cache"in e&&o.push(e)};let l;a(t);do{for(l=!1;o.length>0;)this.renderCaches(t,o),l=!0,a(t);for(;n.length>0;)this.renderTextures(t,n),l=!0,a(t);for(;i.length>0;)this.renderFilters(t,i),l=!0,a(t)}while(l);this.renderObjects(t,e,r,s)}renderTextures(t,e){const r=this.glState.gl;let s=null,n=null;const i=new Map,o=()=>{if(!s||!n||0===i.size)return;const e=(0,B.C)(_.Ue(),s.width,s.height,!1),o=this.renderPool.takeTexture(s.width,s.height),a=this.renderPool.takeRenderbuffer(s.width,s.height);this.textureReturnBox.push(o),this.renderbufferReturnBox.push(a),this.render(n.renders,a.framebuffer,e,(()=>{this.glState.setClearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT)})),o.framebuffer.ensure(this.glState),this.glState.bindFramebuffer(r.READ_FRAMEBUFFER,a.framebuffer.framebuffer),this.glState.bindFramebuffer(r.DRAW_FRAMEBUFFER,o.framebuffer.framebuffer),r.blitFramebuffer(0,0,s.width,s.height,0,0,s.width,s.height,r.COLOR_BUFFER_BIT,r.NEAREST);for(const[e,r]of i){const s=new y(null);s.transform=e.transform,e.texture.then(s,o.texture,r);const n=t.indexOf(e);t.splice(n,1,...s.renders)}};for(const t of e){const{bounds:e,paddings:r,scale:a,translate:l,fn:h}=t.texture,u=new y(null),c=_.vc(_.Ue(),[r[0]+l[0]-Math.floor(l[0]),r[1]+l[1]-Math.floor(l[1])]);_.bA(c,c,a),_.Iu(c,c,[-e[0],-e[1]]),u.pushTransform(c),h(u),u.popTransform();const d=u.bounds,f=Math.ceil(Math.abs(d[0])+d[2]+r[0]),m=Math.ceil(Math.abs(d[1])+d[3]+r[1]);let p;s&&n&&(p=s.add(f,m))||(o(),s=new L(Math.max(N,k(f)),Math.max(N,k(m))),n=new y(null),i.clear(),p=s.add(f,m)),_.vc(c,[p[0],p[1]]),n.pushTransform(c),n.renderContext(u),n.popTransform(),i.set(t,p)}o()}renderCaches(t,e){const r=this.glState.gl;for(const s of e){const{texture:e,bounds:n,view:i,then:o}=s.cache,a=k(n[2]),l=k(n[3]),h=this.renderPool.takeTexture(a,l),u=new F(e);try{u.ensure(this.glState),h.framebuffer.ensure(this.glState),this.glState.bindFramebuffer(r.READ_FRAMEBUFFER,u.framebuffer),this.glState.bindFramebuffer(r.DRAW_FRAMEBUFFER,h.framebuffer.framebuffer),r.blitFramebuffer(n[0],n[1],n[0]+n[2],n[1]+n[3],0,0,n[2],n[3],r.COLOR_BUFFER_BIT,r.NEAREST)}finally{u.delete()}o(new D(this.renderPool,h,i,p.J.fromValues(0,0,n[2],n[3])));const c=t.indexOf(s);t.splice(c,1)}}renderFilters(t,e){let r=null,s=null;const n=new Map,i=()=>{if(!r||!s||0===n.size)return;const e=this.renderPool.takeTexture(r.width,r.height);this.textureReturnBox.push(e),s.apply(this,Array.from(n.values()),e);for(const[r,{outBounds:s}]of n){const n=new y(null);n.transform=r.transform,r.filter.then(n,e.texture,s);const i=t.indexOf(r);t.splice(i,1,...n.renders)}r=null,n.clear()},o=new Map;for(const t of e){const e=t.filter.instance.filter;let r=o.get(e);r||(r=[],o.set(e,r)),r.push(t)}for(const[t,e]of o){s=t;for(const t of e){const{texture:e,bounds:s,instance:o}=t.filter;let a;r&&(a=r.add(s[2],s[3]))||(i(),r=new L(Math.max(N,k(s[2])),Math.max(N,k(s[3]))),a=r.add(s[2],s[3]));const l={instance:o,texture:e,inBounds:s,outBounds:a};n.set(t,l)}i()}}renderObjects(t,e,r,s){var n,i;const o=this.glState.gl,{width:a,height:l}=e.colorAttachment;this.glState.setViewport(0,0,a,l);const h=[],u=[];try{const c=new Map,d=[];for(const e of t){if(!e.transform.renderMask){d.push(e);continue}const t=e.transform.renderMask,r=c.get(t);if(r)p.J.apply(U,e.object.bounds,e.transform.view),p.J.union(r.bounds,r.bounds,U),r.renders.push(e);else{const r=p.J.create();p.J.apply(r,e.object.bounds,e.transform.view),c.set(t,{renders:[e],bounds:r})}}const f=new Map,_=[];for(const[t,{bounds:e,renders:r}]of c){let s=null;for(const t of _){let r=!1;for(const s of t.bounds)if(p.J.intersects(s,e)){r=!0;break}if(!r&&t.nextID<256){s=t;break}}s||(s={target:this.renderPool.takeTexture(a,l),nextID:1,renders:[],bounds:[]},u.push(s.target),_.push(s));const n=s.nextID++;f.set(t,{texture:s.target.texture,id:n}),s.bounds.push(e);for(const t of r)s.renders.push({maskTex:null,maskID:n,render:t})}if(_.length>0){const t=this.renderPool.takeRenderbuffer(a,l);h.push(t),t.framebuffer.ensure(this.glState),this.glState.setClearColor(0,0,0,0);for(const e of _)this.glState.bindFramebuffer(o.FRAMEBUFFER,t.framebuffer.framebuffer),o.clear(o.COLOR_BUFFER_BIT),this.doRenderObjects(e.renders,!0,r),e.target.framebuffer.ensure(this.glState),this.glState.bindFramebuffer(o.READ_FRAMEBUFFER,t.framebuffer.framebuffer),this.glState.bindFramebuffer(o.DRAW_FRAMEBUFFER,e.target.framebuffer.framebuffer),o.blitFramebuffer(0,0,a,l,0,0,a,l,o.COLOR_BUFFER_BIT,o.NEAREST)}e.ensure(this.glState),this.glState.bindFramebuffer(o.FRAMEBUFFER,e.framebuffer),s();const m=[];for(const t of d){const e=t.transform.useMask[t.transform.useMask.length-1],r=f.get(e);e&&!r||m.push({maskTex:null!==(n=null==r?void 0:r.texture)&&void 0!==n?n:null,maskID:null!==(i=null==r?void 0:r.id)&&void 0!==i?i:0,render:t})}this.doRenderObjects(m,!1,r)}finally{for(const t of h)this.renderPool.returnRenderbuffer(t);for(const t of u)this.renderPool.returnTexture(t)}}doRenderObjects(t,e,r){const s=this.glState.gl;this.glState.enable(s.BLEND),this.glState.setBlendEquation(s.FUNC_ADD),this.glState.setBlendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA);const n=r[0],i=r[1],o=r[2],a=r[3],l=r[4],h=r[5];let u=0,c=0;const d=[E.x.WHITE],f=()=>{if(0===c)return;this.indices.update(this.glState,0,c),this.attributes.update(this.glState,0,14*u);for(const t of d)t.ensure(this.glState);const t=this.glState.bindTextures(d.map((t=>t.texture)));this.textureUnits.fill(t[0]),this.textureUnits.set(t),this.renderProgram.uniform(this.glState,"uTextures[0]",this.textureUnits),this.glState.useProgram(this.renderProgram.program),this.renderVertexArray.bind(this.glState),s.drawElements(s.TRIANGLES,c,s.UNSIGNED_SHORT,0),u=0,c=0,d.length=1},_=this.indices.data,m=this.attrFloat,p=this.attrUint;for(const{render:r,maskTex:s,maskID:g}of t){const{kind:t,vertices:b,indices:v,uvMatrix:y,colors:x}=r.object,T=b.length/2,E=v.length;(u+T>=65536||c+E>=O)&&f();const{view:w,colorMul:R,colorAdd:M}=r.transform,A=this.loadTexture(r.object.texture);let F=d.indexOf(A),S=s?d.indexOf(s):-1;-1===F&&(d.length>=this.glState.maxTextures&&f(),F=d.push(A)-1),s&&-1===S&&(d.length>=this.glState.maxTextures&&(f(),F=d.push(A)-1),S=d.push(s)-1);for(let t=0;t<E;t++)_[c+t]=v[t]+u;const L=r.object.fillMode+4*F;let B=0;e?B=1:g>0&&(B=2+4*S);const C=65536*g+256*B+L,D="shape"===t,N=14*u,U=w[0],k=w[1],P=w[2],I=w[3],j=w[4],J=w[5],W=y[0],G=y[1],V=y[2],H=y[3],K=y[4],Y=y[5],$=R[0],X=R[1],z=R[2],q=R[3],Q=M[0]/255,Z=M[1]/255,tt=M[2]/255,et=M[3]/255;for(let t=0;t<T;t++){const e=b[2*t],r=b[2*t+1],s=x[t];let u=U*e+P*r+j,c=k*e+I*r+J;if(D){const t=Math.max(1,this.glState.maxSamples);u=Math.round(u*t)/t,c=Math.round(c*t)/t}m[N+14*t+0]=n*u+o*c+l,m[N+14*t+1]=i*u+a*c+h,m[N+14*t+2]=W*e+V*r+K,m[N+14*t+3]=G*e+H*r+Y,p[N+14*t+4]=s,m[N+14*t+5]=$,m[N+14*t+6]=X,m[N+14*t+7]=z,m[N+14*t+8]=q,m[N+14*t+9]=Q,m[N+14*t+10]=Z,m[N+14*t+11]=tt,m[N+14*t+12]=et,p[N+14*t+13]=C}u+=T,c+=E}f()}}class I{constructor(t){this.fps=t,this.onFrame=new x,this.onRender=new x,this.channel=new MessageChannel,this.lastTimestamp=0,this.needRender=!1,this._onFrame=()=>{try{this.onFrame.emit()}catch(t){console.error(t)}this.needRender=!0},this._onRender=t=>{const e=this.lastTimestamp;if(t-e>=this.targetMS&&(this.lastTimestamp=t-(t-e)%this.targetMS,this.channel.port2.postMessage(null)),this.needRender){try{this.onRender.emit()}catch(t){console.error(t)}this.needRender=!1}this.animationHandle=requestAnimationFrame(this._onRender)},this.targetMS=1e3/t,this.channel.port1.onmessage=()=>{this._onFrame()}}begin(){this.end(),this.animationHandle=requestAnimationFrame(this._onRender)}end(){null!=this.animationHandle&&(cancelAnimationFrame(this.animationHandle),this.animationHandle=void 0)}}var j,J,W,G=r(8281),V=r(1049),H=r(5723),K=r(8682),Y=r(8433),$=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};const X=c.Ue();class z extends i._{constructor(t){super(),this.__displayListDirty=!1,this.__displayList=[],this.__constructionQueue=[],this.__mousePosition=c.Ue(),this.__mouseOn=null,this.__mouseTrackTarget=null,this.focus=null,this.__quality="HIGH",this.__onFrame=this.__withContext((()=>{(0,Y.E)(!0,this)})),this.__doRender=this.__withContext((()=>{this.__onRender(),this.__renderer.renderFrame(this.__node),this.__renderer.blitFrame()})),j.set(this,this.__withContext((t=>{this.__canvas.resolveCoords(this.__mousePosition,t.clientX,t.clientY);let e=this.__hitTestObject(this.__mousePosition);const r=(e,r)=>{if(!r)return;r.__globalToLocal(X,this.__mousePosition,!1);const s=new V.T(e,!0,!1);s.buttonDown=0!==t.buttons,s.localX=X[0],s.localY=X[1],s.stageX=this.__mousePosition[0],s.stageY=this.__mousePosition[1],r.dispatchEvent(s)};switch(this.__mouseTrackTarget&&(this.__mouseTrackTarget.stage!==this&&(this.__mouseTrackTarget=null),e=this.__mouseTrackTarget),"mouseleave"===t.type&&(e=null),this.__mouseOn!==e&&(r(V.T.MOUSE_OUT,this.__mouseOn),this.__mouseOn=e,r(V.T.MOUSE_OVER,this.__mouseOn)),t.type){case"mousemove":r(V.T.MOUSE_MOVE,this.__mouseOn);break;case"mousedown":r(V.T.MOUSE_DOWN,this.__mouseOn);break;case"mouseup":r(V.T.MOUSE_UP,this.__mouseOn);break;case"click":r(V.T.CLICK,this.__mouseOn)}this.__mouseOn?this.__canvas.cursor=this.__mouseOn.__isPointerCursor?"pointer":"default":this.__canvas.cursor="default"}))),J.set(this,this.__withContext((t=>{var e,r;const s=null!==(e=K.N.codeMap[t.key])&&void 0!==e?e:K.N.codeMap[t.code];if(!s)return;let n;switch(t.type){case"keydown":n=new H._(H._.KEY_DOWN,!0,!1);break;case"keyup":n=new H._(H._.KEY_UP,!0,!1);break;default:return}n.keyCode=s,(null!==(r=this.focus)&&void 0!==r?r:this).dispatchEvent(n)}))),W.set(this,this.__withContext((t=>{let e;switch(t.type){case"blur":e=new G.j(G.j.DEACTIVATE,!0,!1);break;default:return}this.dispatchEvent(e)})));let e=60,r=0,s=600,n=400;t&&(({width:s,height:n,backgroundColor:r,fps:e}=t),s/=20,n/=20),this.__canvas=new f(s,n),this.__renderer=new P(this.__canvas),this.__renderer.backgroundColor=r,this.__ticker=new I(e),this.__ticker.onFrame.subscribe(this.__onFrame),this.__ticker.onRender.subscribe(this.__doRender),this.__ticker.begin();const i=this.__canvas.element;i.addEventListener("mouseenter",$(this,j)),i.addEventListener("mousemove",$(this,j)),i.addEventListener("mousedown",$(this,j)),i.addEventListener("mouseup",$(this,j)),i.addEventListener("mouseleave",$(this,j)),i.addEventListener("click",$(this,j)),i.addEventListener("keydown",$(this,J)),i.addEventListener("keyup",$(this,J)),i.addEventListener("blur",$(this,W))}get loaderInfo(){return{bytesTotal:100,bytesLoaded:100,url:window.location.href}}get stage(){return this}get quality(){return this.__quality}set quality(t){this.__quality!==t&&(this.__quality=t,"HIGH"===this.__quality?this.__renderer.glState.sampleLimit=4:this.__renderer.glState.sampleLimit=0,this.__renderer.glState.resetRenderState(),this.__onRender(),this.__renderer.renderFrame(this.__node))}__withContext(t){return(...e)=>{const r=z.__current;z.__current=this;try{return t(...e)}finally{z.__current=r}}}__hitTestObject(t){this.__node.ensureLayout();const e=r=>{if(!(r instanceof i._))return r;const s=r.__children;let n=!1;for(let r=s.length-1;r>=0;r--){const i=s[r];if(i.visible&&i.__node.hitTest(t,!1))if(i instanceof o.D){const t=e(i);if(t)return t}else n=!0}return n?r:null};return e(this)}__ensureDisplayList(){if(!this.__displayListDirty)return;this.__displayList.length=1,this.__displayList[0]=this;let t=0;for(;t<this.__displayList.length;){const e=this.__displayList[t].__node.children;for(let t=0;t<e.length;t++)this.__displayList.push(e[t].object);t++}this.__displayListDirty=!1}}j=new WeakMap,J=new WeakMap,W=new WeakMap,z.__current=null;var q,Q=r(2166),Z=r(2741),tt=r(1719),et=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class rt extends o.D{constructor(){var t,e;super(),this.__soundContext=new tt.$,this.__state=Q.B.Up,this.trackAsMenu=!1,this.useHandCursor=!0,q.set(this,(t=>{var e,r;let s=this.__state,n=t.type!==Z.MouseEvent.MOUSE_OUT&&t.buttonDown;s=t.type===Z.MouseEvent.MOUSE_OUT?Q.B.Up:t.buttonDown&&this.hitTestPoint(t.stageX,t.stageY)?Q.B.Down:Q.B.Over;const i=this.stage;if(this.__state!==s){const t=this.__state;this.__state=s,this.__node.buttonState=s,null===(e=this.__character)||void 0===e||e.instantiateState(this,s),null===(r=this.__character)||void 0===r||r.stateTransition(this,t,s),i&&(i.__displayListDirty=!0)}!this.trackAsMenu&&i&&(n?i.__mouseTrackTarget=this:i.__mouseTrackTarget===this&&(i.__mouseTrackTarget=null))})),this.__state=Q.B.Up,this.__states=[new n.s,new n.s,new n.s,new n.s];for(const t of this.__states)t.__node.setParent(this.__node,this.__node.children.length);this.__character=null!==(t=this.constructor.__character)&&void 0!==t?t:null,null===(e=this.__character)||void 0===e||e.applyTo(this),this.__node.buttonState=this.__state,this.addEventListener(Z.MouseEvent.MOUSE_OVER,et(this,q)),this.addEventListener(Z.MouseEvent.MOUSE_OUT,et(this,q)),this.addEventListener(Z.MouseEvent.MOUSE_DOWN,et(this,q)),this.addEventListener(Z.MouseEvent.MOUSE_UP,et(this,q)),this.addEventListener(Z.MouseEvent.MOUSE_MOVE,et(this,q))}get __activeState(){switch(this.__state){case Q.B.Up:return this.upState;case Q.B.Over:return this.overState;case Q.B.Down:return this.downState}}get upState(){return this.__states[Q.B.Up]}set upState(t){this.__states[Q.B.Up].__node.setParent(null,0),this.__states[Q.B.Up]=t,t.__node.setParent(this.__node,Q.B.Up)}get overState(){return this.__states[Q.B.Over]}set overState(t){this.__states[Q.B.Over].__node.setParent(null,0),this.__states[Q.B.Over]=t,t.__node.setParent(this.__node,Q.B.Over)}get downState(){return this.__states[Q.B.Down]}set downState(t){this.__states[Q.B.Down].__node.setParent(null,0),this.__states[Q.B.Down]=t,t.__node.setParent(this.__node,Q.B.Down)}get hitTestState(){return this.__states[Q.B.HitTest]}set hitTestState(t){this.__states[Q.B.HitTest].__node.setParent(null,0),this.__states[Q.B.HitTest]=t,t.__node.setParent(this.__node,Q.B.HitTest)}get __isPointerCursor(){return this.useHandCursor||super.__isPointerCursor}}q=new WeakMap;var st=r(7964),nt=r(2942),it=r(230);class ot extends st.i{constructor(t,e,r=!0,s=4294967295){super(),this.width=t,this.height=e,this.transparent=r,this.fillColor=s,this.__root=new it.B(null),this.__needRender=!1,this.__needPixel=!1,this.__pixels=null,this.__target=null,this.__renderer=null,this.rect=new nt.A(0,0,t,e)}draw(t,e,r,s){const n=t.__node.clone();n.visible=!0,e?_.JG(n.transformLocal,e.__value):_.yR(n.transformLocal),r?(m.JG(n.colorTransformLocalMul,r.__mul),m.JG(n.colorTransformLocalAdd,r.__add)):(m.t8(n.colorTransformLocalMul,1,1,1,1),m.t8(n.colorTransformLocalAdd,0,0,0,0)),n.setParent(this.__root,this.__root.children.length),this.__needRender=!0}colorTransform(t,e){this.__render();const r=this.__target;this.__target=null;try{const[s,n,i,o]=t.__rect,a=(t,s)=>{if(t[2]<=0||t[3]<=0)return;const n=new it.B(null);n.setRenderObjects([C.r.rect(t,r.texture,{invertY:!0})],p.J.fromValues(0,0,t[2],t[3])),_.vc(n.transformLocal,[t[0],t[1]]),s&&(m.JG(n.colorTransformLocalMul,e.__mul),m.JG(n.colorTransformLocalAdd,e.__add)),n.setParent(this.__root,this.__root.children.length)};a(p.J.fromValues(0,0,this.width,n),!1),a(p.J.fromValues(0,n,s,o),!1),a(p.J.fromValues(s,n,i,o),!0),a(p.J.fromValues(s+i,n,this.width-(s+i),o),!1),a(p.J.fromValues(0,n+o,this.width,this.height-(n+o)),!1),this.__render()}finally{this.__renderer.renderPool.returnTexture(r)}}getPixel32(t,e){if(this.__render(),this.__needPixel||!this.__pixels){this.__pixels||(this.__pixels=new Uint32Array(this.width*this.height));const t=this.__renderer.glState,e=t.gl;this.__target.framebuffer.ensure(t),t.bindFramebuffer(e.READ_FRAMEBUFFER,this.__target.framebuffer.framebuffer);const r=new Uint8Array(this.__pixels.buffer);e.readPixels(0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,r),this.__needPixel=!1}const r=Math.floor(t)+(this.height-Math.floor(e))*this.width,s=this.__pixels[r];return 16777216*(s>>>24&255)+65536*(s>>>0&255)+256*(s>>>8&255)+1*(s>>>16&255)}lock(){}unlock(){}copyPixels(t,e,r){this.__render(),t.__render();const s=this.__renderer.glState,n=s.gl,i=t.__target,o=this.__target,a=e.x,l=this.height-e.y-e.height,h=r.x,u=this.height-r.y-e.height;i.framebuffer.ensure(s),o.framebuffer.ensure(s),s.bindFramebuffer(n.READ_FRAMEBUFFER,i.framebuffer.framebuffer),s.bindFramebuffer(n.DRAW_FRAMEBUFFER,o.framebuffer.framebuffer),n.blitFramebuffer(a,l,a+e.width,l+e.height,h,u,h+e.width,u+e.height,n.COLOR_BUFFER_BIT,n.NEAREST)}scroll(t,e){this.__render();const r=this.__target,s=this.__renderer;this.__target=s.renderPool.takeTexture(this.width,this.height);try{const n=r.framebuffer,i=this.__target.framebuffer,o=this.__renderer.glState,a=o.gl;n.ensure(o),i.ensure(o),o.bindFramebuffer(a.READ_FRAMEBUFFER,n.framebuffer),o.bindFramebuffer(a.DRAW_FRAMEBUFFER,i.framebuffer),a.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,a.COLOR_BUFFER_BIT,a.NEAREST),a.blitFramebuffer(0,0,this.width,this.height,t,-e,t+this.width,-e+this.height,a.COLOR_BUFFER_BIT,a.NEAREST)}finally{s.renderPool.returnTexture(r)}}dispose(){var t;this.__target&&(null===(t=this.__renderer)||void 0===t||t.renderPool.returnTexture(this.__target),this.__target=null),this.__needRender=!0}__render(){if(this.__target&&!this.__needRender)return;if(!this.__renderer){if(!z.__current)throw new Error("No stage in context");this.__renderer=z.__current.__renderer}let t=()=>{};if(!this.__target){const e=this.__renderer.glState;this.__target=this.__renderer.renderPool.takeTexture(this.width,this.height),t=()=>{e.setClearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT)}}const e=this.__renderer.renderPool.takeRenderbuffer(this.width,this.height);try{const r=this.__renderer.glState,s=r.gl;this.__renderer.renderNode(this.__root,e.framebuffer,this.width,this.height,t),this.__target.framebuffer.ensure(r),r.bindFramebuffer(s.READ_FRAMEBUFFER,e.framebuffer.framebuffer),r.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.__target.framebuffer.framebuffer),s.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,s.COLOR_BUFFER_BIT,s.NEAREST),this.__root.onRemoveFromStage(),this.__root=new it.B(null),this.__needRender=!1,this.__needPixel=!0}finally{this.__renderer.renderPool.returnRenderbuffer(e)}}}class at extends n.s{constructor(t){super(),this.bitmapData=t;const{width:e,height:r}=this.bitmapData,s=p.J.fromValues(0,0,e,r);this.__node.setRenderObjects([C.r.rect(s,E.x.WHITE,{texWidth:e,texHeight:r,invertY:!0})],s)}__onRender(){super.__onRender(),this.bitmapData.__render(),this.bitmapData.__target&&(this.__node.renderObjects[0].texture=this.bitmapData.__target.texture)}}class lt extends i._{}},8281:(t,e,r)=>{"use strict";r.d(e,{j:()=>s});class s{constructor(t,e=!1,r=!1){this.type=t,this.bubbles=e,this.cancelable=r}formatToString(t,...e){return`${t}(${e.map((t=>this[t])).join(", ")})`}}s.ENTER_FRAME="ENTER_FRAME",s.ADDED_TO_STAGE="ADDED_TO_STAGE",s.REMOVED_FROM_STAGE="REMOVED_FROM_STAGE",s.SOUND_COMPLETE="SOUND_COMPLETE",s.DEACTIVATE="DEACTIVATE"},570:(t,e,r)=>{"use strict";r.d(e,{p:()=>f,$:()=>_});var s,n,i,o,a,l=r(7964),h=r(8281),u=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};const c=Symbol(),d=[h.j.ENTER_FRAME];class f extends l.i{constructor(){super(...arguments),this[a]=!1,s.set(this,null),n.set(this,new Map),i.set(this,new Map),o.set(this,((t,e)=>{let r;r=u(this,e?n:i);for(const{listener:e}of r.get(t.type)||[])e(t)}))}__setEventParent(t){!function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");e.set(t,r)}(this,s,t)}addEventListener(t,e,r=!1,s=0,o=!1){if(d.includes(t)&&!this[c])return void _.addEventListener(t,e,r,s,o);let a;a=u(this,r?n:i);const l=a.get(t)||[];if(l.find((t=>t.listener===e)))return;const h=[...l,{priority:s,listener:e}];h.sort(((t,e)=>e.priority-t.priority)),a.set(t,h)}removeEventListener(t,e,r=!1,s=0,o=!1){if(d.includes(t)&&!this[c])return void _.removeEventListener(t,e,r,s,o);let a;a=u(this,r?n:i);const l=a.get(t)||[],h=l.filter((t=>t.listener!==e));h.length!==l.length&&a.set(t,h)}dispatchEvent(t){var e,r;if(t.target=this,!t.bubbles)return t.currentTarget=this,void u(this,o).call(this,t,!1);const n=[this];let i=this;for(;i&&u(i,s);)i=u(i,s),n.push(i);for(let r=n.length-1;r>0;r--)t.currentTarget=n[r],u(e=n[r],o).call(e,t,!0);for(let e=0;e<n.length;e++)t.currentTarget=n[e],u(r=n[e],o).call(r,t,!1)}}s=new WeakMap,n=new WeakMap,i=new WeakMap,o=new WeakMap,a=c;const _=new f;_[c]=!0},5723:(t,e,r)=>{"use strict";r.d(e,{_:()=>n});var s=r(8281);class n extends s.j{constructor(){super(...arguments),this.keyCode=0}}n.KEY_DOWN="KEY_DOWN",n.KEY_UP="KEY_UP"},1049:(t,e,r)=>{"use strict";r.d(e,{T:()=>n});var s=r(8281);class n extends s.j{constructor(){super(...arguments),this.buttonDown=!1,this.localX=0,this.localY=0,this.stageX=0,this.stageY=0}}n.CLICK="click",n.MOUSE_DOWN="mouseDown",n.MOUSE_MOVE="mouseMove",n.MOUSE_OUT="mouseOut",n.MOUSE_OVER="mouseOver",n.MOUSE_UP="mouseUp"},2741:(t,e,r)=>{"use strict";r.r(e),r.d(e,{ErrorEvent:()=>h,Event:()=>s.j,EventDispatcher:()=>n.p,FocusEvent:()=>d,IOErrorEvent:()=>u,KeyboardEvent:()=>a._,MouseEvent:()=>i.T,SecurityErrorEvent:()=>c,TextEvent:()=>l,TimerEvent:()=>o,__broadcastDispatcher:()=>n.$});var s=r(8281),n=r(570),i=r(1049);class o extends s.j{}var a=r(5723);class l extends s.j{constructor(){super(...arguments),this.text=""}}class h extends l{}class u extends h{}u.IO_ERROR="IO_ERROR";class c extends h{}c.SECURITY_ERROR="SECURITY_ERROR";class d extends s.j{}},9793:(t,e,r)=>{"use strict";r.d(e,{l:()=>s});class s{}},8051:(t,e,r)=>{"use strict";r.d(e,{T:()=>d});var s=r(9793),n=r(5543),i=r(1215),o=r(2526),a=r(2550);const l=o.Ue(),h=n.Ue(),u=n.Ue();class c{isEffective(t){return t.blurX>0||t.blurY>0}apply(t,e,r){const s=t.glState,o=s.gl,{width:c,height:d}=r.texture;(0,a.C)(l,c,d,!1),n.t8(u,1/c,1/d),s.setViewport(0,0,c,d),s.disable(o.BLEND),s.setClearColor(0,0,0,0);const f=t.renderPool.takeTexture(c,d),_=t.renderPool.takeTexture(c,d);try{const a=[];let c=0,d=null,m=null;const p=()=>{if(!d||!m)return;const t=(0,i.$_)(c),e=a.length;i.Qb.update(s,0,4*e*17);let n=f,l=_;for(let a=0;a<2*m;a++){let h=n,u=l.texture,c=a%2;0===a?(u=d,c+=2):a===2*m-1&&(h=r),h.framebuffer.ensure(s),s.bindFramebuffer(o.FRAMEBUFFER,h.framebuffer.framebuffer),t.ensure(s),i.BR.ensure(s),u.ensure(s),s.useProgram(t.program);const f=s.bindTextures([u.texture])[0];t.uniform(s,"uTexture",f),t.uniform(s,"uMode",c),i.BR.bind(s),o.drawElements(o.TRIANGLES,6*e,o.UNSIGNED_SHORT,0);let _=l;l=n,n=_}a.length=0,m=null,d=null};for(const t of e){t.texture===d&&t.instance.passes===m||(p(),d=t.texture,m=t.instance.passes,n.t8(h,1/d.width,1/d.height));const e=t.instance.blurX/2,r=t.instance.blurY/2;c=Math.max(c,e,r);let s=4*a.length*17;for(let o=0;o<4;o++){switch(i.t9[s+0]=e,i.t9[s+1]=r,o){case 0:i.t9[s+2]=t.outBounds[0]+t.outBounds[2],i.t9[s+3]=t.outBounds[1],i.t9[s+4]=t.inBounds[0]+t.inBounds[2],i.t9[s+5]=t.inBounds[1],i.t9[s+6]=t.outBounds[0]+t.outBounds[2],i.t9[s+7]=t.outBounds[1];break;case 1:i.t9[s+2]=t.outBounds[0],i.t9[s+3]=t.outBounds[1]+t.outBounds[3],i.t9[s+4]=t.inBounds[0],i.t9[s+5]=t.inBounds[1]+t.inBounds[3],i.t9[s+6]=t.outBounds[0],i.t9[s+7]=t.outBounds[1]+t.outBounds[3];break;case 2:i.t9[s+2]=t.outBounds[0],i.t9[s+3]=t.outBounds[1],i.t9[s+4]=t.inBounds[0],i.t9[s+5]=t.inBounds[1],i.t9[s+6]=t.outBounds[0],i.t9[s+7]=t.outBounds[1];break;case 3:i.t9[s+2]=t.outBounds[0]+t.outBounds[2],i.t9[s+3]=t.outBounds[1]+t.outBounds[3],i.t9[s+4]=t.inBounds[0]+t.inBounds[2],i.t9[s+5]=t.inBounds[1]+t.inBounds[3],i.t9[s+6]=t.outBounds[0]+t.outBounds[2],i.t9[s+7]=t.outBounds[1]+t.outBounds[3]}i.t9[s+8]=t.inBounds[0]+.5,i.t9[s+9]=t.inBounds[1]+.5,i.t9[s+10]=t.inBounds[0]+t.inBounds[2]-1.5,i.t9[s+11]=t.inBounds[1]+t.inBounds[3]-1.5,i.t9[s+12]=t.outBounds[0]+.5,i.t9[s+13]=t.outBounds[1]+.5,i.t9[s+14]=t.outBounds[0]+t.outBounds[2]-1.5,i.t9[s+15]=t.outBounds[1]+t.outBounds[3]-1.5;const a=i.t9.subarray(s+0,s+2),c=i.t9.subarray(s+2,s+4),d=i.t9.subarray(s+4,s+6),f=i.t9.subarray(s+6,s+8),_=i.t9.subarray(s+8,s+10),m=i.t9.subarray(s+10,s+12),p=i.t9.subarray(s+12,s+14),g=i.t9.subarray(s+14,s+16);n.dC(a,a,h),n.iu(c,c,l),n.dC(d,d,h),n.dC(_,_,h),n.dC(m,m,h),n.dC(f,f,u),n.dC(p,p,u),n.dC(g,g,u),s+=17}a.push(t)}p()}finally{t.renderPool.returnTexture(f),t.renderPool.returnTexture(_)}}}c.instance=new c;class d extends s.l{constructor(t=4,e=4,r=1){super(),this.blurX=t,this.blurY=e,this.quality=r}get __filter(){return{filter:c.instance,paddings:n.al(this.blurX,this.blurY),blurX:this.blurX,blurY:this.blurY,passes:this.quality}}}},3633:(t,e,r)=>{"use strict";r.d(e,{p:()=>o});var s=r(5543),n=r(9793),i=r(1788);class o extends n.l{constructor(){super(...arguments),this.blurX=0,this.blurY=0,this.quality=3,this.color=16777215,this.strength=1,this.angle=45,this.distance=4,this.knockout=!1,this.hideObject=!1,this.inner=!1}get __filter(){return{filter:i.p.instance,paddings:s.al(this.blurX+this.distance,this.blurY+this.distance),blurX:this.blurX,blurY:this.blurY,passes:this.quality,color:this.color,strength:this.strength,angle:this.angle*Math.PI/180,distance:this.distance,knockout:this.knockout}}}},1151:(t,e,r)=>{"use strict";r.d(e,{J:()=>n});var s=r(4945);class n{constructor(t=1,e=1,r=1,n=1,i=0,o=0,a=0,l=0){this.__node=null,this.__mul=s.al(t,e,r,n),this.__add=s.al(i,o,a,l)}get redMultiplier(){return this.__mul[0]}set redMultiplier(t){this.__mul[0]=t}get greenMultiplier(){return this.__mul[1]}set greenMultiplier(t){this.__mul[1]=t}get blueMultiplier(){return this.__mul[2]}set blueMultiplier(t){this.__mul[2]=t}get alphaMultiplier(){return this.__mul[3]}set alphaMultiplier(t){this.__mul[3]=t}get redOffset(){return this.__add[0]}set redOffset(t){this.__add[0]=t}get greenOffset(){return this.__add[1]}set greenOffset(t){this.__add[1]=t}get blueOffset(){return this.__add[2]}set blueOffset(t){this.__add[2]=t}get alphaOffset(){return this.__add[3]}set alphaOffset(t){this.__add[3]=t}__setNode(t){t?(s.JG(t.colorTransformLocalMul,this.__mul),s.JG(t.colorTransformLocalAdd,this.__add),this.__mul=t.colorTransformLocalMul,this.__add=t.colorTransformLocalAdd):(this.__mul=s.d9(this.__mul),this.__add=s.d9(this.__add)),this.__node=t}set color(t){this.__add[0]=t>>>16&255,this.__add[1]=t>>>8&255,this.__add[2]=t>>>0&255,this.__mul[0]=0,this.__mul[1]=0,this.__mul[2]=0}}},7562:(t,e,r)=>{"use strict";r.d(e,{y:()=>i});var s=r(2526),n=r(230);class i{constructor(t=1,e=0,r=0,n=1,i=0,o=0){this.__node=null,this.__value=s.al(t,e,r,n,i,o)}__setNode(t){t?(s.JG(t.transformLocal,this.__value),this.__value=t.transformLocal):this.__value=s.d9(this.__value)}translate(t,e){var r;this.__value[4]=(0,n.V)(this.__value[4]+t),this.__value[5]=(0,n.V)(this.__value[5]+e),null===(r=this.__node)||void 0===r||r.markLayoutDirty()}scale(t,e){var r;this.__value[0]*=t,this.__value[1]*=e,this.__value[2]*=t,this.__value[3]*=e,this.__value[4]=(0,n.V)(this.__value[4]*t),this.__value[5]=(0,n.V)(this.__value[5]*e),null===(r=this.__node)||void 0===r||r.markLayoutDirty()}rotate(t){var e;const r=this.__value[0],s=this.__value[1],i=this.__value[2],o=this.__value[3],a=this.__value[4],l=this.__value[5],h=Math.sin(t),u=Math.cos(t);this.__value[0]=r*h-s*u,this.__value[1]=r*u+s*h,this.__value[2]=i*h-o*u,this.__value[3]=i*u+o*h,this.__value[4]=(0,n.V)(a*h-l*u),this.__value[5]=(0,n.V)(a*u+l*h),null===(e=this.__node)||void 0===e||e.markLayoutDirty()}}},7069:(t,e,r)=>{"use strict";r.d(e,{E:()=>n});var s=r(5543);class n{constructor(t=0,e=0){this.__value=s.Ue(),s.t8(this.__value,t,e)}get x(){return this.__value[0]}set x(t){this.__value[0]=t}get y(){return this.__value[1]}set y(t){this.__value[1]=t}}},2942:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var s=r(8671);class n{constructor(t=0,e=0,r=0,n=0){this.__rect=s.J.fromValues(t,e,r,n)}get x(){return this.__rect[0]}set x(t){this.__rect[0]=t}get y(){return this.__rect[1]}set y(t){this.__rect[1]=t}get width(){return this.__rect[2]}set width(t){this.__rect[2]=t}get height(){return this.__rect[3]}set height(t){this.__rect[3]=t}equals(t){return s.J.equals(this.__rect,t.__rect)}}n.__empty=new n},8745:(t,e,r)=>{"use strict";r.d(e,{w:()=>i});var s=r(7562),n=r(1151);class i{constructor(){this.__node=null,this.__matrix=new s.y,this.__colorTransform=new n.J}__setNode(t){this.__node=t,this.matrix.__setNode(t),this.colorTransform.__setNode(t)}get matrix(){return this.__matrix}set matrix(t){this.__matrix.__setNode(null),this.__matrix=t,this.__matrix.__setNode(this.__node)}get colorTransform(){return this.__colorTransform}set colorTransform(t){this.__colorTransform.__setNode(null),this.__colorTransform=t,this.__colorTransform.__setNode(this.__node)}}},1719:(t,e,r)=>{"use strict";r.d(e,{$:()=>s});class s{constructor(){this.soundChannels=new Map}syncSound(t,e,r){var s;if((r.syncNoMultiple||r.syncStop)&&(null===(s=this.soundChannels.get(e))||void 0===s||s.stop(),this.soundChannels.delete(e)),r.syncStop)return;const n=t.instantiateCharacter(e);let i=0,o=1;null!=r.inPoint&&(i=r.inPoint/n.__character.audio.sampleRate*1e3),null!=r.loopCount&&(o=r.loopCount);const a=n.play(i,o);this.soundChannels.set(e,a)}stopSound(t){var e;null===(e=this.soundChannels.get(t))||void 0===e||e.stop()}}},2829:(t,e,r)=>{"use strict";r.r(e),r.d(e,{Sound:()=>h,SoundChannel:()=>a,SoundMixer:()=>u,SoundTransform:()=>l});var s=r(570),n=r(8281),i=r(6375);const o=new Set;class a extends s.p{constructor(t,e,r,s){super(),this.isStopped=!1,this.__audioNode=i.B.createBufferSource(),this.__volumeNode=i.B.createGain(),this.__audioNode.buffer=t,this.__audioNode.connect(this.__volumeNode),this.__volumeNode.connect(i.o),"suspended"===i.B.state&&i.B.resume(),this.__soundTransform=e,this.__soundTransform.__source=this,this.__updateSoundTransform();const a=i.B.currentTime;this.__beginTime=a-r,this.__duration=t.duration,this.__audioNode.loop=!0,this.__audioNode.loopStart=0,this.__audioNode.start(a,r),this.__audioNode.stop(this.__beginTime+Math.min(Math.max(1,s)*this.__duration,1e6)),this.__audioNode.onended=()=>{this.__volumeNode.disconnect(),this.__audioNode.disconnect(),o.delete(this),this.isStopped||this.dispatchEvent(new n.j(n.j.SOUND_COMPLETE,!1,!1))},o.add(this)}get soundTransform(){return this.__soundTransform}set soundTransform(t){this.__soundTransform.__source=null,this.__soundTransform=t,this.__soundTransform.__source=this,this.__updateSoundTransform()}get position(){return(i.B.currentTime-this.__beginTime)%this.__duration*1e3}stop(){this.isStopped=!0,this.__audioNode.stop()}__updateSoundTransform(){this.__volumeNode.gain.setValueAtTime(this.__soundTransform.volume,i.B.currentTime)}}class l{constructor(t=1){this.__source=null,this.__volume=t}get volume(){return this.__volume}set volume(t){var e;this.__volume=t,null===(e=this.__source)||void 0===e||e.__updateSoundTransform()}}class h extends s.p{constructor(){var t;super(),this.__character=null!==(t=this.constructor.__character)&&void 0!==t?t:null}get length(){var t,e;return 1e3*(null!==(e=null===(t=this.__character)||void 0===t?void 0:t.audio.duration)&&void 0!==e?e:0)}play(t=0,e=0,r=null){if(!this.__character)throw new Error("Sound character not exist");return new a(this.__character.audio,null!=r?r:new l,t/1e3,e)}}class u{static get soundTransform(){return u.__soundTransform}static set soundTransform(t){u.__soundTransform.__source=null,u.__soundTransform=t,u.__soundTransform.__source=u,u.__updateSoundTransform()}static stopAll(){for(const t of o)t.stop()}static __updateSoundTransform(){i.o.gain.setValueAtTime(this.soundTransform.volume,i.B.currentTime)}}u.__soundTransform=new l},3441:(t,e,r)=>{"use strict";r.d(e,{V:()=>n});var s=r(2640);class n extends s.s{constructor(){var t,e;super(),this.__character=null!==(t=this.constructor.__character)&&void 0!==t?t:null,null===(e=this.__character)||void 0===e||e.applyTo(this)}}},7264:(t,e,r)=>{"use strict";r.d(e,{S:()=>n});var s=r(313);class n{constructor(){this.align=s.O.LEFT,this.bold=!1,this.italic=!1,this.color=0,this.font="Times New Roman",this.size=12,this.leading=0}__clone(){const t=new n;return t.align=this.align,t.bold=this.bold,t.italic=this.italic,t.color=this.color,t.font=this.font,t.size=this.size,t.leading=this.leading,t}}},313:(t,e,r)=>{"use strict";var s;r.d(e,{O:()=>s}),function(t){t.CENTER="center",t.END="end",t.JUSTIFY="justify",t.LEFT="left",t.RIGHT="right",t.START="start"}(s||(s={}))},2389:(t,e,r)=>{"use strict";r.r(e),r.d(e,{StaticText:()=>n.V,TextField:()=>a,TextFieldType:()=>s,TextFormat:()=>l.S,TextFormatAlign:()=>h.O});var s,n=r(3441),i=r(9956),o=r(8077);!function(t){t.DYNAMIC="dynamic",t.INPUT="input"}(s||(s={}));class a extends o.D{constructor(){var t,e;super(),this.__container=new i.W(this.__node),this.type=s.DYNAMIC,this.selectable=!0,this.__character=null!==(t=this.constructor.__character)&&void 0!==t?t:null,null===(e=this.__character)||void 0===e||e.applyTo(this)}get wordWrap(){return this.__container.wordWrap}set wordWrap(t){this.__container.wordWrap=t}get multiline(){return this.__container.multiline}set multiline(t){this.__container.multiline=t}get defaultTextFormat(){return this.__container.defaultTextFormat}set defaultTextFormat(t){this.__container.defaultTextFormat=t}get textColor(){return this.__container.defaultTextFormat.color}set textColor(t){this.__container.defaultTextFormat.color=t}get text(){return this.__container.text}set text(t){this.__container.text=t}get htmlText(){return this.__container.htmlText}set htmlText(t){this.__container.htmlText=t}}var l=r(7264),h=r(313)},8682:(t,e,r)=>{"use strict";r.d(e,{N:()=>s});class s{}s.NUMBER_0=48,s.NUMBER_1=49,s.NUMBER_2=50,s.NUMBER_3=51,s.NUMBER_4=52,s.NUMBER_5=53,s.NUMBER_6=54,s.NUMBER_7=55,s.NUMBER_8=56,s.NUMBER_9=57,s.A=65,s.B=66,s.C=67,s.D=68,s.E=69,s.F=70,s.G=71,s.H=72,s.I=73,s.J=74,s.K=75,s.L=76,s.M=77,s.N=78,s.O=79,s.P=80,s.Q=81,s.R=82,s.S=83,s.T=84,s.U=85,s.V=86,s.W=87,s.X=88,s.Y=89,s.Z=90,s.SEMICOLON=186,s.EQUAL=187,s.COMMA=188,s.MINUS=189,s.PERIOD=190,s.SLASH=191,s.BACKQUOTE=192,s.LEFTBRACKET=219,s.BACKSLASH=220,s.RIGHTBRACKET=221,s.QUOTE=222,s.ALTERNATE=18,s.BACKSPACE=8,s.CAPS_LOCK=20,s.COMMAND=15,s.CONTROL=17,s.DELETE=46,s.DOWN=40,s.END=35,s.ENTER=13,s.ESCAPE=27,s.F1=112,s.F2=113,s.F3=114,s.F4=115,s.F5=116,s.F6=117,s.F7=118,s.F8=119,s.F9=120,s.F10=121,s.F11=122,s.F12=123,s.F13=124,s.F14=125,s.F15=126,s.HOME=36,s.INSERT=45,s.LEFT=37,s.NUMPAD=21,s.NUMPAD_0=96,s.NUMPAD_1=97,s.NUMPAD_2=98,s.NUMPAD_3=99,s.NUMPAD_4=100,s.NUMPAD_5=101,s.NUMPAD_6=102,s.NUMPAD_7=103,s.NUMPAD_8=104,s.NUMPAD_9=105,s.NUMPAD_ADD=107,s.NUMPAD_DECIMAL=110,s.NUMPAD_DIVIDE=111,s.NUMPAD_ENTER=108,s.NUMPAD_MULTIPLY=106,s.NUMPAD_SUBTRACT=109,s.PAGE_DOWN=34,s.PAGE_UP=33,s.RIGHT=39,s.SHIFT=16,s.SPACE=32,s.TAB=9,s.UP=38,s.RED=16777216,s.GREEN=16777217,s.YELLOW=16777218,s.BLUE=16777219,s.CHANNEL_UP=16777220,s.CHANNEL_DOWN=16777221,s.RECORD=16777222,s.PLAY=16777223,s.PAUSE=16777224,s.STOP=16777225,s.FAST_FORWARD=16777226,s.REWIND=16777227,s.SKIP_FORWARD=16777228,s.SKIP_BACKWARD=16777229,s.NEXT=16777230,s.PREVIOUS=16777231,s.LIVE=16777232,s.LAST=16777233,s.MENU=16777234,s.INFO=16777235,s.GUIDE=16777236,s.EXIT=16777237,s.BACK=16777238,s.AUDIO=16777239,s.SUBTITLE=16777240,s.DVR=16777241,s.VOD=16777242,s.INPUT=16777243,s.SETUP=16777244,s.HELP=16777245,s.MASTER_SHELL=16777246,s.SEARCH=16777247,s.codeMap={Digit0:s.NUMBER_0,Digit1:s.NUMBER_1,Digit2:s.NUMBER_2,Digit3:s.NUMBER_3,Digit4:s.NUMBER_4,Digit5:s.NUMBER_5,Digit6:s.NUMBER_6,Digit7:s.NUMBER_7,Digit8:s.NUMBER_8,Digit9:s.NUMBER_9,KeyA:s.A,KeyB:s.B,KeyC:s.C,KeyD:s.D,KeyE:s.E,KeyF:s.F,KeyG:s.G,KeyH:s.H,KeyJ:s.J,KeyK:s.K,KeyL:s.L,KeyM:s.M,KeyN:s.N,KeyO:s.O,KeyP:s.P,KeyQ:s.Q,KeyR:s.R,KeyS:s.S,KeyT:s.T,KeyU:s.U,KeyV:s.V,KeyW:s.W,KeyX:s.X,KeyY:s.Y,KeyZ:s.Z,Semicolon:s.SEMICOLON,Equal:s.EQUAL,Comma:s.COMMA,Minus:s.MINUS,Period:s.PERIOD,Slash:s.SLASH,Backquote:s.BACKQUOTE,BracketLeft:s.LEFTBRACKET,Backslash:s.BACKSLASH,BracketRight:s.RIGHTBRACKET,Quote:s.QUOTE,AltLeft:s.ALTERNATE,AltRight:s.ALTERNATE,Backspace:s.BACKSPACE,CapsLock:s.CAPS_LOCK,ControlLeft:s.CONTROL,ControlRight:s.CONTROL,Delete:s.DELETE,ArrowDown:s.DOWN,End:s.END,Enter:s.ENTER,Escape:s.ESCAPE,F1:s.F1,F2:s.F2,F3:s.F3,F4:s.F4,F5:s.F5,F6:s.F6,F7:s.F7,F8:s.F8,F9:s.F9,F10:s.F10,F11:s.F11,F12:s.F12,F13:s.F13,F14:s.F14,F15:s.F15,Home:s.HOME,Insert:s.INSERT,ArrowLeft:s.LEFT,Numpad0:s.NUMPAD_0,Numpad1:s.NUMPAD_1,Numpad2:s.NUMPAD_2,Numpad3:s.NUMPAD_3,Numpad4:s.NUMPAD_4,Numpad5:s.NUMPAD_5,Numpad6:s.NUMPAD_6,Numpad7:s.NUMPAD_7,Numpad8:s.NUMPAD_8,Numpad9:s.NUMPAD_9,NumpadAdd:s.NUMPAD_ADD,NumpadDecimal:s.NUMPAD_DECIMAL,NumpadDivide:s.NUMPAD_DIVIDE,NumpadEnter:s.NUMPAD_ENTER,NumpadMultiply:s.NUMPAD_MULTIPLY,NumpadSubtract:s.NUMPAD_SUBTRACT,PageDown:s.PAGE_DOWN,PageUp:s.PAGE_UP,ArrowRight:s.RIGHT,ShiftLeft:s.SHIFT,ShiftRight:s.SHIFT,Space:s.SPACE,Tab:s.TAB,ArrowUp:s.UP}},8193:(t,e,r)=>{"use strict";r.d(e,{Z:()=>O});var s={};r.r(s),r.d(s,{ColorTransform:()=>_.J,Matrix:()=>d.y,Point:()=>p.E,Rectangle:()=>m.A,Transform:()=>f.w});var n={};r.r(n),r.d(n,{BitmapFilter:()=>v.l,BlurFilter:()=>y.T,DropShadowFilter:()=>x.p,GlowFilter:()=>w});var i={};r.r(i),r.d(i,{SharedObject:()=>A,URLRequest:()=>R,navigateToURL:()=>F});var o={};r.r(o),r.d(o,{Keyboard:()=>L.N});var a={};r.r(a),r.d(a,{Timer:()=>B,getDefinitionByName:()=>D,getTimer:()=>C});var l={};r.r(l),r.d(l,{display:()=>c,events:()=>g,filters:()=>n,geom:()=>s,media:()=>S,net:()=>i,text:()=>b,ui:()=>o,utils:()=>a});var h={};r.r(h),r.d(h,{__internal:()=>u,flash:()=>l});var u=r(94),c=r(7381),d=r(7562),f=r(8745),_=r(1151),m=r(2942),p=r(7069),g=r(2741),b=r(2389),v=r(9793),y=r(8051),x=r(3633),T=r(5543),E=r(1788);class w extends v.l{constructor(t=16711680,e=1,r=6,s=6,n=2,i=1,o=!1,a=!1){super(),this.color=t,this.alpha=e,this.blurX=r,this.blurY=s,this.strength=n,this.quality=i,this.inner=o,this.knockout=a}get __filter(){return{filter:E.p.instance,paddings:T.al(this.blurX,this.blurY),blurX:this.blurX,blurY:this.blurY,passes:this.quality,color:16777216*Math.floor(255*this.alpha)+this.color,strength:this.strength,angle:0,distance:0,knockout:this.knockout}}}class R{constructor(t){this.url=t}}var M=r(570);class A extends M.p{constructor(t){super(),this.name=t;try{this.data=JSON.parse(localStorage[t])||{}}catch(t){this.data={}}}static getLocal(t){return new A(t)}flush(){localStorage[this.name]=JSON.stringify(this.data)}}function F(t,e){window.open(t.url,e)}var S=r(2829),L=r(8682);class B extends M.p{constructor(t=0,e=0){super(),this.delay=t}start(){}stop(){}}function C(){return+new Date}function D(t){const e=u.ClassRegistry.instance.classes.get(t);return null!=e?e:null}const O=h},6375:(t,e,r)=>{"use strict";r.d(e,{B:()=>s,o:()=>n});const s=new AudioContext,n=s.createGain();n.connect(s.destination)},2166:(t,e,r)=>{"use strict";r.d(e,{B:()=>s,p:()=>a});var s,n=r(6300),i=r(5950),o=r(843);!function(t){t[t.Up=0]="Up",t[t.Over=1]="Over",t[t.Down=2]="Down",t[t.HitTest=3]="HitTest"}(s||(s={}));class a{constructor(t,e,r){this.id=t,this.def=e,this.library=r}applyTo(t){this.instantiateState(t,s.Up),this.instantiateState(t,s.Over),this.instantiateState(t,s.Down),this.instantiateState(t,s.HitTest),t.trackAsMenu=this.def.trackAsMenu}instantiateState(t,e){const r=new n.j;let a;switch(e){case s.Up:a=t=>t.up;break;case s.Over:a=t=>t.over;break;case s.Down:a=t=>t.down;break;case s.HitTest:a=t=>t.hitTest}for(const t of this.def.characters)a(t)&&(0,o.WO)(this.library,r,{kind:i.z.PlaceObject,depth:t.depth,characterId:t.characterId,moveCharacter:!1,version:3,matrix:t.matrix,colorTransform:t.colorTransform,filters:t.filters,blendMode:t.blendMode});switch((0,o.PU)(r),e){case s.Up:t.upState=r;break;case s.Over:t.overState=r;break;case s.Down:t.downState=r;break;case s.HitTest:t.hitTestState=r}}stateTransition(t,e,r){let n;e===s.Over&&r===s.Up?n=this.def.overUpToIdle:e===s.Up&&r===s.Over?n=this.def.idleToOverUp:e===s.Over&&r===s.Down?n=this.def.overUpToOverDown:e===s.Down&&r===s.Over&&(n=this.def.idleToOverUp),n&&(0,o.jf)(this.library,t.__soundContext,{kind:i.z.StartSound,characterId:n.characterId,soundInfo:n.soundInfo})}}},843:(t,e,r)=>{"use strict";r.d(e,{WO:()=>u,Ff:()=>c,jf:()=>d,PU:()=>_});var s,n=r(2526),i=r(4945),o=r(2640),a=r(2120),l=r(8051),h=r(3633);function u(t,e,r){const s=e.__children;let a;if(r.characterId){let l=s.findIndex((t=>t.__depth>=r.depth)),h=null;if(-1===l)l=s.length;else if(s[l].__depth===r.depth){const t=s[l].__character;(null==t?void 0:t.id)===r.characterId?a=s[l]:(h=s[l],e.removeChildAt(l))}if(a)f(e,a,r,!r.moveCharacter);else{const{characterId:s,depth:a}=r;o.s.__initChar((()=>t.instantiateCharacter(s)),(t=>{var s,o;e.addChildAt(t,l),t.__depth=a,h&&(s=h,o=t,n.JG(o.__node.transformLocal,s.__node.transformLocal),i.JG(o.__node.colorTransformLocalMul,s.__node.colorTransformLocalMul),i.JG(o.__node.colorTransformLocalAdd,s.__node.colorTransformLocalMul),o.__clipDepth=s.__clipDepth,o.name=s.name,o.filters=s.filters,o.cacheAsBitmap=s.cacheAsBitmap,o.visible=s.visible),f(e,t,r,!r.moveCharacter)}))}}else a=s.find((t=>t.__depth===r.depth)),a&&f(e,a,r,!1)}function c(t,e){const r=t.__children.findIndex((t=>t.__depth===e.depth));r<0||t.removeChildAt(r)}function d(t,e,r){e.syncSound(t,r.characterId,r.soundInfo)}function f(t,e,r,o){var u,c;if(null!=r.matrix?(n.JG(e.__node.transformLocal,r.matrix),e.__node.transformLocal[4]/=20,e.__node.transformLocal[5]/=20,e.__node.markLayoutDirty()):o&&(n.yR(e.__node.transformLocal),e.__node.markLayoutDirty()),null!=r.colorTransform?(i.JG(e.__node.colorTransformLocalMul,r.colorTransform.slice(0,4)),i.JG(e.__node.colorTransformLocalAdd,r.colorTransform.slice(4,8))):o&&(i.t8(e.__node.colorTransformLocalMul,1,1,1,1),i.t8(e.__node.colorTransformLocalAdd,0,0,0,0)),!(r.version<=1||(null!=r.clipDepth?e.__clipDepth=r.clipDepth:o&&(e.__clipDepth=-1),e instanceof a.W&&(null!=r.ratio?(e.__ratio=r.ratio,null===(u=e.__character)||void 0===u||u.applyTo(e)):o&&(e.__ratio=0,null===(c=e.__character)||void 0===c||c.applyTo(e))),null!=r.name&&(e.name=r.name,t[e.name]=e),r.version<=2))){if(null!=r.filters){const t=[];for(const e of r.filters)switch(e.id){case s.Blur:{const r=new l.T;r.blurX=e.blurX,r.blurY=e.blurY,r.quality=e.passes,t.push(r);break}case s.DropShadow:{const r=new h.p;r.color=e.color,r.blurX=e.blurX,r.blurY=e.blurY,r.angle=180*e.angle/Math.PI,r.distance=e.distance,r.strength=e.strength,r.inner=e.inner,r.knockout=e.knockout,r.quality=e.passes,t.push(r);break}}e.filters=t}else o&&(e.filters=[]);null!=r.cacheAsBitmap?e.cacheAsBitmap=r.cacheAsBitmap:o&&(e.cacheAsBitmap=!1),null!=r.visible?e.visible=r.visible:o&&(e.visible=!0)}}function _(t){const e=[];for(const r of t.__children)r.__clipDepth>=0&&e.push(r);for(const r of t.__children)for(const t of e)r.__depth>t.__depth&&r.__depth<=t.__clipDepth&&(r.mask=t)}!function(t){t[t.DropShadow=0]="DropShadow",t[t.Blur=1]="Blur"}(s||(s={}))},5355:(t,e,r)=>{"use strict";r.d(e,{u_:()=>n,K1:()=>i,fE:()=>o});var s=r(4945);function n(t){let e=t>>>24&255,r=t>>>16&255,s=t>>>8&255,n=t>>>0&255;const i=e/255;return r=255&Math.round(r*i),s=255&Math.round(s*i),n=255&Math.round(n*i),1*r+256*s+65536*n+16777216*e}function i(t,e){return t[0]=(e>>>0&255)/255,t[1]=(e>>>8&255)/255,t[2]=(e>>>16&255)/255,t[3]=(e>>>24&255)/255,t}function o(t,e,r,n,i,o){s.dC(t,i,r),s.dC(e,o,r),s.IH(e,e,n)}},2550:(t,e,r)=>{"use strict";r.d(e,{C:()=>n});var s=r(2526);function n(t,e,r,n){return s.yR(t),t[0]=2/e,t[3]=(n?-2:2)/r,t[4]=-1,t[5]=n?1:-1,t}},8671:(t,e,r)=>{"use strict";r.d(e,{J:()=>i});var s=r(5543);const n=1e-6,i={create:()=>Float32Array.of(0,0,0,0),fromValues:(t,e,r,s)=>Float32Array.of(t,e,r,s),copy:(t,e)=>(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t),equals:(t,e)=>t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3],intersects:(t,e)=>t[0]-(e[0]+e[2])<-n&&e[0]-(t[0]+t[2])<-n&&t[1]-(e[1]+e[3])<-n&&e[1]-(t[1]+t[3])<-n,contains:(t,e,r)=>e>=t[0]&&e<t[0]+t[2]&&r>=t[1]&&r<t[1]+t[3],clear:t=>(t[0]=0,t[1]=0,t[2]=0,t[3]=0,t),scale:(t,e,r)=>(t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t),translate:(t,e,r)=>(t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2],t[3]=e[3],t),union(t,e,r){0===e[2]||0===e[3]?i.copy(t,r):0!==r[2]&&0!==r[3]||i.copy(t,e);const s=Math.min(e[0],r[0]),n=Math.min(e[1],r[1]),o=Math.max(e[0]+e[2],r[0]+r[2]),a=Math.max(e[1]+e[3],r[1]+r[3]);return t[0]=s,t[1]=n,t[2]=o-s,t[3]=a-n,t},apply(t,e,r){const n=[0,0];let[i,o]=s.iu(n,[e[0],e[1]],r),a=i,l=o,h=i,u=o;return[i,o]=s.iu(n,[e[0]+e[2],e[1]],r),a=Math.min(a,i),l=Math.min(l,o),h=Math.max(h,i),u=Math.max(u,o),[i,o]=s.iu(n,[e[0],e[1]+e[3]],r),a=Math.min(a,i),l=Math.min(l,o),h=Math.max(h,i),u=Math.max(u,o),[i,o]=s.iu(n,[e[0]+e[2],e[1]+e[3]],r),a=Math.min(a,i),l=Math.min(l,o),h=Math.max(h,i),u=Math.max(u,o),t[0]=a,t[1]=l,t[2]=h-a,t[3]=u-l,t}}},1645:(t,e,r)=>{"use strict";r.d(e,{r:()=>a});var s=r(8671),n=r(2526),i=r(5543),o=r(1552);class a{constructor(t,e,r,s,n,i,o,a){this.kind=t,this.vertices=e,this.colors=r,this.indices=s,this.uvMatrix=n,this.texture=i,this.fillMode=o,this.bounds=a}static rect(t,e,r){const{invertY:s=!1,texWidth:i=e.width,texHeight:o=e.height}=null!=r?r:{},l=new Float32Array(8);l[0]=t[2],l[1]=0,l[2]=0,l[3]=t[3],l[4]=0,l[5]=0,l[6]=t[2],l[7]=t[3];const h=new Uint32Array(4);h.fill(4294967295);const u=new Uint16Array(6);u[0]=0,u[1]=1,u[2]=2,u[3]=1,u[4]=0,u[5]=3;const c=n.Ue();return n.bA(c,c,[1/i,1/o]),s&&(n.bA(c,c,[1,-1]),n.Iu(c,c,[0,-o])),n.Iu(c,c,[t[0],t[1]]),new a("shape",l,h,u,c,e,0,t)}static line(t,e,r,i,l,h){const u=function(t,e,r,s){const n=r-t,i=s-e,o=Math.sqrt(n*n+i*i);return[-i/o,n/o]}(t,e,r,i),c=l/2,d=new Float32Array(8);d[0]=r-u[0]*c,d[1]=i-u[1]*c,d[2]=t+u[0]*c,d[3]=e+u[1]*c,d[4]=t-u[0]*c,d[5]=e-u[1]*c,d[6]=r+u[0]*c,d[7]=i+u[1]*c;const f=new Uint32Array(4);f.fill(h);const _=new Uint16Array(6);_[0]=0,_[1]=1,_[2]=2,_[3]=1,_[4]=0,_[5]=3;const m=n.Ue(),p=s.J.create();return p[0]=Math.min(t,r),p[1]=Math.min(e,i),p[2]=Math.max(t,r)-p[0],p[3]=Math.max(e,i)-p[1],new a("shape",d,f,_,m,o.x.WHITE,0,p)}hitTest(t,e,r){if(!r)return s.J.contains(this.bounds,t,e);const n=(r,s,n,i)=>(t-n)*(s-i)-(r-n)*(e-i),i=this.vertices,o=this.indices,a=o.length/3;for(let t=0;t<a;t++){const e=i[2*o[3*t+0]+0],r=i[2*o[3*t+0]+1],s=i[2*o[3*t+1]+0],a=i[2*o[3*t+1]+1],l=i[2*o[3*t+2]+0],h=i[2*o[3*t+2]+1],u=n(e,r,s,a),c=n(s,a,l,h),d=n(l,h,e,r),f=u>0||c>0||d>0;if(!(u<0||c<0||d<0)||!f)return!0}return!1}static merge(t,e){let r=0,s=0;const n=[],i=[];for(const o of e)s+o.renderObject.indices.length>=65536&&(i.push(l(t,n,r,s)),r=0,s=0,n.length=0),r+=o.renderObject.vertices.length/2,s+=o.renderObject.indices.length,n.push(o);return s>0&&i.push(l(t,n,r,s)),i}}function l(t,e,r,o){const l=new Float32Array(2*r),h=new Uint32Array(r),u=new Uint16Array(o),c=s.J.create();let d=0,f=0;for(const{renderObject:t,color:r,transform:n}of e){for(let e=0;e<t.vertices.length;e+=2){const r=l.subarray(2*d+e,2*d+e+2),s=t.vertices.subarray(e,e+2);i.iu(r,s,n)}null==r?h.set(t.colors,d):h.fill(r,d,d+t.colors.length),u.set(t.indices.map((t=>t+d)),f),s.J.union(c,c,s.J.apply(s.J.create(),t.bounds,n)),d+=t.vertices.length/2,f+=t.indices.length}return new a(t,l,h,u,n.yR(n.Ue()),null,0,c)}},230:(t,e,r)=>{"use strict";r.d(e,{V:()=>h,B:()=>m});var s,n=r(2526),i=r(5543),o=r(4945),a=r(1645),l=r(8671);function h(t){return Math.round(20*t)/20}!function(t){t[t.DirtyBounds=1]="DirtyBounds",t[t.DirtyTransform=2]="DirtyTransform",t[t.DirtyChildTransform=4]="DirtyChildTransform",t[t.DirtyRender=8]="DirtyRender",t[t.DirtyAll=15]="DirtyAll",t[t.IsRoot=128]="IsRoot"}(s||(s={}));const u=l.J.create(),c=l.J.create(),d=n.Ue(),f=n.Ue(),_=i.Ue();class m{constructor(t){this.object=t,this.flags=s.DirtyAll,this.parent=null,this.mask=null,this.children=[],this.visible=!0,this.isMask=!1,this.buttonState=-1,this.renderObjects=[],this.boundsIntrinsic=l.J.create(),this.cacheAsBitmap=!1,this.cachedRender=null,this.filters=[],this.transformLocal=n.Ue(),this.colorTransformLocalMul=o.al(1,1,1,1),this.colorTransformLocalAdd=o.al(0,0,0,0),this.boundsLocal=l.J.create(),this.boundsWorld=l.J.create(),this.transformRender=n.Ue(),this.transformWorld=n.Ue(),this.transformWorldInvert=n.Ue()}markRenderDirty(){let t=this;for(;t&&0==(t.flags&s.DirtyRender);)t.flags|=s.DirtyRender,t=t.parent}markLayoutDirty(t=!0){let e=this;for(;e;)e.flags|=s.DirtyBounds,e=e.parent;if(!t)return;for(e=this;e;)e.flags|=s.DirtyChildTransform,e=e.parent;const r=[this];for(;e=r.pop();){e.flags|=s.DirtyTransform|s.DirtyChildTransform;for(const t of e.children)r.push(t)}}ensureLayout(){const t=[this];let e;for(;e=t.pop();){if(e.parent&&0!=(e.parent.flags&s.DirtyTransform)){t.push(e.parent);continue}if(e.flags&s.DirtyChildTransform&&(t.push(...e.children),e.flags&=~s.DirtyChildTransform),0==(e.flags&s.DirtyTransform))continue;e.parent?(n.Jp(d,e.parent.transformWorld,e.transformLocal),n.Jp(f,e.parent.transformRender,e.transformLocal)):(n.JG(d,e.transformLocal),n.JG(f,e.transformLocal)),e.cacheAsBitmap&&n.yR(f);const r=!n.I6(d,e.transformWorld),i=!n.I6(f,e.transformRender);if(e.flags&=~s.DirtyTransform,r){n.JG(e.transformWorld,d),n.U_(e.transformWorldInvert,e.transformWorld),l.J.apply(e.boundsWorld,e.boundsLocal,e.transformWorld);let t=e.parent;for(;t;)t.flags|=s.DirtyBounds,t=t.parent;for(const t of e.children)t.flags|=s.DirtyTransform}if(i){n.JG(e.transformRender,f);let t=e;for(;t;)t.flags|=s.DirtyRender,t=t.parent}}for(t.push(this);e=t.pop();){if(0==(e.flags&s.DirtyBounds))continue;let r=!1;for(const n of e.children)0!=(n.flags&s.DirtyBounds)&&(r||(r=!0,t.push(e)),t.push(n));if(r)continue;l.J.copy(u,e.boundsIntrinsic);for(const t of e.children)l.J.apply(c,t.boundsLocal,t.transformLocal),l.J.union(u,u,c);const i=!l.J.equals(u,e.boundsLocal);e.flags&=~s.DirtyBounds,i&&(n.JG(e.boundsLocal,u),l.J.apply(e.boundsWorld,e.boundsLocal,e.transformWorld),e.parent&&(e.parent.flags|=s.DirtyBounds,t.push(e.parent)))}}setParent(t,e){if(this.parent!==t){if(this.parent){const t=this.parent.children.indexOf(this);this.parent.children.splice(t,1),this.parent.markLayoutDirty(!1)}this.parent=t,this.parent?this.parent.children.splice(e,0,this):0==(this.flags&s.IsRoot)&&this.onRemoveFromStage(),this.markLayoutDirty()}else if(t){const r=t.children.indexOf(this);t.children.splice(r,1),t.children.splice(e,0,this),t.markRenderDirty()}}setRenderObjects(t,e){this.renderObjects=t,l.J.copy(this.boundsIntrinsic,e),this.markLayoutDirty(!1)}render(t){this.ensureLayout(),this.renderRecursive(t)}renderRecursive(t){t.pushTransform(this.transformLocal,{colorMul:this.colorTransformLocalMul,colorAdd:this.colorTransformLocalAdd}),this.doRender(t),t.popTransform()}doRender(t){var e;if(this.visible&&(!this.isMask||t.transform.renderMask===this)&&(l.J.apply(u,this.boundsLocal,t.transform.view),!t.viewport||l.J.intersects(u,t.viewport))){if(this.cacheAsBitmap&&this.cachedRender&&0==(this.flags&s.DirtyRender))return t.pushTransform(this.cachedRender.view),t.renderObject(this.cachedRender.renderObject),void t.popTransform();this.flags&=~s.DirtyRender,null===(e=this.cachedRender)||void 0===e||e.return(),this.cachedRender=null,this.doRenderMask(t)}}doRenderMask(t){const e=this.mask;e&&(n.U_(d,this.transformWorld),n.Jp(d,d,e.transformWorld),t.pushTransform(d,{renderMask:e}),e.doRender(t),t.popTransform(),t.transform.useMask.push(e)),this.doRenderFilter(t)}doRenderFilter(t){if(this.cacheAsBitmap||this.filters.length>0){const e=i.Ue();for(const t of this.filters)i.Fp(e,e,t.paddings);i.mD(e,e);const r=t.transform.view,s=this.filters.slice(),n=(t,e,i)=>{const o=s.shift();o?t.renderFilter(e,i,o,n):this.cacheAsBitmap?(t.renderCache(e,i,r,(t=>{this.cachedRender=t})),t.renderObject(a.r.rect(i,e))):t.renderObject(a.r.rect(i,e))};t.renderTexture(this.boundsLocal,e,(t=>this.doRenderContent(t)),n)}else this.doRenderContent(t)}doRenderContent(t){for(const e of this.renderObjects)t.renderObject(e);if(this.buttonState>=0)this.children[this.buttonState].render(t);else for(const e of this.children)e.renderRecursive(t)}onRemoveFromStage(){var t;null===(t=this.cachedRender)||void 0===t||t.return(),this.cachedRender=null;for(const t of this.children)t.onRemoveFromStage()}hitTest(t,e){if(this.buttonState>=0)return this.children[3].hitTest(t,!0);if(this.mask&&!this.mask.hitTest(t,e))return!1;if(!e)return this.ensureLayout(),i.iu(_,t,this.transformWorldInvert),l.J.contains(this.boundsLocal,_[0],_[1]);const r=[this];let s;for(;s=r.pop();){if(s.renderObjects.length>0&&(i.iu(_,t,s.transformWorldInvert),s.renderObjects.some((t=>t.hitTest(_[0],_[1],e)))))return!0;for(const t of s.children)r.push(t)}return!1}clone(){const t=new Map,e=r=>{let s=t.get(r);if(s)return s;s=new m(r.object),t.set(r,s),s.visible=r.visible,s.isMask=r.isMask,s.buttonState=r.buttonState,s.renderObjects=r.renderObjects.slice(),s.cacheAsBitmap=r.cacheAsBitmap,s.filters=r.filters.slice(),l.J.copy(s.boundsIntrinsic,r.boundsIntrinsic),n.JG(s.transformLocal,r.transformLocal),o.JG(s.colorTransformLocalMul,r.colorTransformLocalMul),o.JG(s.colorTransformLocalAdd,r.colorTransformLocalAdd),s.mask=r.mask&&e(r.mask);for(const t of r.children){const r=e(t);s.children.push(r),r.parent=s}return s};return e(this)}}},1788:(t,e,r)=>{"use strict";r.d(e,{p:()=>d});var s=r(2526),n=r(5543),i=r(4945),o=r(1215),a=r(2550),l=r(5355);const h=s.Ue(),u=n.Ue(),c=n.Ue();class d{isEffective(t){return t.blurX>0||t.blurY>0||t.distance>0}apply(t,e,r){const s=t.glState,d=s.gl,{width:f,height:_}=r.texture;(0,a.C)(h,f,_,!1),n.t8(c,1/f,1/_),s.setViewport(0,0,f,_),s.disable(d.BLEND),s.setClearColor(0,0,0,0);const m=t.renderPool.takeTexture(f,_),p=t.renderPool.takeTexture(f,_);try{const a=[];let f=0,_=null,g=null;const b=()=>{if(!_||!g)return;const t=(0,o.$_)(f),e=a.length;o.Qb.update(s,0,4*e*17);let h=m,u=p;for(let r=0;r<2*g;r++){let n=h,i=u.texture,a=r%2;0===r&&(i=_,a+=2),n.framebuffer.ensure(s),s.bindFramebuffer(d.FRAMEBUFFER,n.framebuffer.framebuffer),t.ensure(s),o.BR.ensure(s),i.ensure(s),s.useProgram(t.program);const l=s.bindTextures([i.texture])[0];t.uniform(s,"uTexture",l),t.uniform(s,"uMode",a),o.BR.bind(s),d.drawElements(d.TRIANGLES,6*e,d.UNSIGNED_SHORT,0);let c=u;u=h,h=c}for(let t=0;t<a.length;t++){const e=(0,l.K1)(i.Ue(),(0,l.u_)(a[t].instance.color));i.bA(e,e,a[t].instance.strength);const r=n.al(a[t].instance.distance,0);n.U1(r,r,[0,0],a[t].instance.angle),n.dC(r,r,c);let s=0;a[t].instance.knockout&&(s|=1);for(let n=0;n<4;n++){const i=17*(4*t+n);o.t9[i+0]=r[0],o.t9[i+1]=r[1],o.t9[i+8]=e[0],o.t9[i+9]=e[1],o.t9[i+10]=e[2],o.t9[i+11]=e[3],o.QF[i+16]=s}}o.Qb.update(s,0,4*e*17),r.framebuffer.ensure(s),s.bindFramebuffer(d.FRAMEBUFFER,r.framebuffer.framebuffer),o.wm.ensure(s),s.useProgram(o.wm.program);const b=s.bindTextures([u.texture.texture,_.texture]);o.wm.uniform(s,"uTextures[0]",b),d.drawElements(d.TRIANGLES,6*e,d.UNSIGNED_SHORT,0),a.length=0,g=null,_=null};for(const t of e){t.texture===_&&t.instance.passes===g||(b(),_=t.texture,g=t.instance.passes,f=0,n.t8(u,1/_.width,1/_.height));const e=t.instance.blurX/2,r=t.instance.blurY/2;f=Math.max(f,e,r);let s=4*a.length*17;for(let i=0;i<4;i++){switch(o.t9[s+0]=e,o.t9[s+1]=r,i){case 0:o.t9[s+2]=t.outBounds[0]+t.outBounds[2],o.t9[s+3]=t.outBounds[1],o.t9[s+4]=t.inBounds[0]+t.inBounds[2],o.t9[s+5]=t.inBounds[1],o.t9[s+6]=t.outBounds[0]+t.outBounds[2],o.t9[s+7]=t.outBounds[1];break;case 1:o.t9[s+2]=t.outBounds[0],o.t9[s+3]=t.outBounds[1]+t.outBounds[3],o.t9[s+4]=t.inBounds[0],o.t9[s+5]=t.inBounds[1]+t.inBounds[3],o.t9[s+6]=t.outBounds[0],o.t9[s+7]=t.outBounds[1]+t.outBounds[3];break;case 2:o.t9[s+2]=t.outBounds[0],o.t9[s+3]=t.outBounds[1],o.t9[s+4]=t.inBounds[0],o.t9[s+5]=t.inBounds[1],o.t9[s+6]=t.outBounds[0],o.t9[s+7]=t.outBounds[1];break;case 3:o.t9[s+2]=t.outBounds[0]+t.outBounds[2],o.t9[s+3]=t.outBounds[1]+t.outBounds[3],o.t9[s+4]=t.inBounds[0]+t.inBounds[2],o.t9[s+5]=t.inBounds[1]+t.inBounds[3],o.t9[s+6]=t.outBounds[0]+t.outBounds[2],o.t9[s+7]=t.outBounds[1]+t.outBounds[3]}o.t9[s+8]=t.inBounds[0]+.5,o.t9[s+9]=t.inBounds[1]+.5,o.t9[s+10]=t.inBounds[0]+t.inBounds[2]-1.5,o.t9[s+11]=t.inBounds[1]+t.inBounds[3]-1.5,o.t9[s+12]=t.outBounds[0]+.5,o.t9[s+13]=t.outBounds[1]+.5,o.t9[s+14]=t.outBounds[0]+t.outBounds[2]-1.5,o.t9[s+15]=t.outBounds[1]+t.outBounds[3]-1.5;const a=o.t9.subarray(s+0,s+2),l=o.t9.subarray(s+2,s+4),d=o.t9.subarray(s+4,s+6),f=o.t9.subarray(s+6,s+8),_=o.t9.subarray(s+8,s+10),m=o.t9.subarray(s+10,s+12),p=o.t9.subarray(s+12,s+14),g=o.t9.subarray(s+14,s+16);n.dC(a,a,u),n.iu(l,l,h),n.dC(d,d,u),n.dC(_,_,u),n.dC(m,m,u),n.dC(f,f,c),n.dC(p,p,c),n.dC(g,g,c),s+=17}a.push(t)}b()}finally{t.renderPool.returnTexture(m),t.renderPool.returnTexture(p)}}}d.instance=new d},1215:(t,e,r)=>{"use strict";r.d(e,{t9:()=>c,QF:()=>d,Qb:()=>f,$_:()=>a,wm:()=>l,BR:()=>_});var s=r(7527),n=r(970),i=r(2106);const o=new Map,a=t=>{const e=Math.max(1,Math.ceil(t/2));let r=o.get(e);return r||(r=new s.$("\n#version 300 es\n\nlayout(location=0) in vec4 aVertex;\nlayout(location=1) in vec4 aTexCoords;\nlayout(location=2) in vec4 aBoundsIn;\nlayout(location=3) in vec4 aBoundsOut;\nlayout(location=4) in uint x;\n\nout vec2 vTextureCoords;\nout vec2 vDelta;\nout vec4 vBounds;\n\nuniform uint uMode;\n\nvoid main(void) {\n    gl_Position = vec4(aVertex.zw, 0.0, 1.0);\n\n    vec2 delta;\n    vec2 texCoords;\n    vec4 bounds;\n    if (int(uMode) % 2 != 0) {\n      delta = aVertex.xy * vec2(1.0, 0.0);\n    } else {\n      delta = aVertex.xy * vec2(0.0, 1.0);\n    }\n    if (int(uMode) / 2 != 0) {\n      texCoords = aTexCoords.xy;\n      bounds = aBoundsIn;\n    } else {\n      texCoords = aTexCoords.zw;\n      bounds = aBoundsOut;\n    }\n\n    vTextureCoords = texCoords;\n    vDelta = delta;\n    vBounds = bounds;\n}\n",(t=>{const e=[0];for(let r=0;r<t;r++){const s=r+1;e.push(s/t),e.unshift(-s/t)}return`\n#version 300 es\nprecision highp float;\n\nin vec2 vTextureCoords;\nin vec2 vDelta;\nin vec4 vBounds;\n\nuniform sampler2D uTexture;\n\nout vec4 fragColor;\n\nvec4 sampleTex(float offset) {\n  vec2 coords = vTextureCoords + vDelta * offset;\n  coords = clamp(coords, vBounds.xy, vBounds.zw);\n  return texture(uTexture, coords);\n}\n\nvoid main(void) {\n  fragColor = vec4(0.0);\n  ${e.map((t=>`fragColor += sampleTex(${t.toFixed(20)}) * ${1/e.length};`)).join("\n")}\n}\n`})(e)),o.set(e,r)),r},l=new s.$("\n#version 300 es\n\nlayout(location=0) in vec4 aVertex;\nlayout(location=1) in vec4 aTexCoords;\nlayout(location=2) in vec4 aColor;\nlayout(location=3) in vec4 aBounds;\nlayout(location=4) in uint aMode;\n\nout vec2 vInTexCoords;\nout vec2 vOutTexCoords;\nout vec2 vDelta;\nout vec4 vBounds;\nout vec4 vColor;\nflat out uint vMode;\n\nvoid main(void) {\n    gl_Position = vec4(aVertex.zw, 0.0, 1.0);\n\n    vInTexCoords = aTexCoords.xy;\n    vOutTexCoords = aTexCoords.zw;\n    vDelta = aVertex.xy;\n    vBounds = aBounds;\n    vColor = aColor;\n    vMode = aMode;\n}\n","\n#version 300 es\nprecision highp float;\n\nin vec2 vInTexCoords;\nin vec2 vOutTexCoords;\nin vec2 vDelta;\nin vec4 vBounds;\nin vec4 vColor;\nflat in uint vMode;\n\nuniform sampler2D uTextures[2];\n\nout vec4 fragColor;\n\nvoid main(void) {\n  vec2 shadowCoords = clamp(vOutTexCoords - vDelta, vBounds.xy, vBounds.zw);\n  vec4 shadow = vColor * texture(uTextures[0], shadowCoords).a;\n  vec4 color = texture(uTextures[1], vInTexCoords);\n  if (int(vMode) % 2 != 0) {\n    fragColor = shadow * (1.0 - color.a);\n  } else {\n    fragColor = shadow * (1.0 - color.a) + color;\n  }\n}\n"),h=n.l.index(new Uint16Array(600),"STREAM_DRAW"),u=new ArrayBuffer(27200),c=new Float32Array(u),d=new Uint32Array(u),f=n.l.vertex(c,"STREAM_DRAW"),_=new i.F([{index:0,buffer:f,type:"float",components:4,offset:0,stride:68},{index:1,buffer:f,type:"float",components:4,offset:16,stride:68},{index:2,buffer:f,type:"float",components:4,offset:32,stride:68},{index:3,buffer:f,type:"float",components:4,offset:48,stride:68},{index:4,buffer:f,type:"uint",components:1,integer:!0,offset:64,stride:68}],h);for(let t=0;t<100;t++)h.data[6*t+0]=4*t+0,h.data[6*t+1]=4*t+1,h.data[6*t+2]=4*t+2,h.data[6*t+3]=4*t+1,h.data[6*t+4]=4*t+0,h.data[6*t+5]=4*t+3},970:(t,e,r)=>{"use strict";r.d(e,{l:()=>s});class s{constructor(t,e,r){this.binding=e,this.usage=r,this.state=null,this.buffer=null,this.onContextLost=()=>{this.state&&(this.state.contextLost.unsubscribe(this.onContextLost),this.state=null),this.buffer=null},this.data=t}get length(){return this.data.length}static index(t,e){return new s(t,"ELEMENT_ARRAY_BUFFER",e)}static vertex(t,e){return new s(t,"ARRAY_BUFFER",e)}ensure(t){if(this.buffer)return;const e=t.gl,r=e.createBuffer();t.bindBuffer(e[this.binding],r),e.bufferData(e[this.binding],this.data,e[this.usage]),this.state=t,this.buffer=r,t.contextLost.subscribe(this.onContextLost)}bind(t){this.ensure(t),t.bindBuffer(t.gl[this.binding],this.buffer)}update(t,e,r){this.bind(t);const s=t.gl;return s.bufferSubData(s[this.binding],0,this.data,e,r),this}}},7527:(t,e,r)=>{"use strict";function s(t,e){if("number"==typeof t||"boolean"==typeof t){const r=new e(1);return r[0]=Number(t),r}if(Array.isArray(t))return e.from(t);if(t instanceof e)return t.slice();throw new Error("Invalid typed array value")}function n(t,e){if(!t||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(e[r]!==t[r])return!1;return!0}r.d(e,{$:()=>o});class i{constructor(t,e,r){this.value=null,this.state=t,this.name=e.name,this.type=e.type,this.size=e.size,this.location=r;const s=this.state.gl,n={[s.FLOAT]:{type:"float",components:1,setter:"uniform1fv"},[s.FLOAT_VEC2]:{type:"float",components:2,setter:"uniform2fv"},[s.FLOAT_VEC3]:{type:"float",components:3,setter:"uniform3fv"},[s.FLOAT_VEC4]:{type:"float",components:4,setter:"uniform4fv"},[s.INT]:{type:"int",components:1,setter:"uniform1iv"},[s.INT_VEC2]:{type:"int",components:2,setter:"uniform2iv"},[s.INT_VEC3]:{type:"int",components:3,setter:"uniform3iv"},[s.INT_VEC4]:{type:"int",components:4,setter:"uniform4iv"},[s.UNSIGNED_INT]:{type:"uint",components:1,setter:"uniform1uiv"},[s.UNSIGNED_INT_VEC2]:{type:"uint",components:2,setter:"uniform2uiv"},[s.UNSIGNED_INT_VEC3]:{type:"uint",components:3,setter:"uniform3uiv"},[s.UNSIGNED_INT_VEC4]:{type:"uint",components:4,setter:"uniform4uiv"},[s.BOOL]:{type:"bool",components:1,setter:"uniform1iv"},[s.BOOL_VEC2]:{type:"bool",components:2,setter:"uniform2iv"},[s.BOOL_VEC3]:{type:"bool",components:3,setter:"uniform3iv"},[s.BOOL_VEC4]:{type:"bool",components:4,setter:"uniform4iv"},[s.FLOAT_MAT2]:{type:"mat",components:4,setter:"uniformMatrix2fv"},[s.FLOAT_MAT3]:{type:"mat",components:9,setter:"uniformMatrix3fv"},[s.FLOAT_MAT4]:{type:"mat",components:16,setter:"uniformMatrix4fv"},[s.SAMPLER_2D]:{type:"bool",components:1,setter:"uniform1iv"}}[e.type];if(!n)throw new Error("Unsupported uniform type: "+e.type);this.typeDef=n}set(t,e){var r,i,o,a,l;switch(this.state.useProgram(t),this.typeDef.type){case"float":{const t=s(e,Float32Array);if(n(null!==(r=this.value)&&void 0!==r?r:new Float32Array(0),t))return;this.state.gl[this.typeDef.setter](this.location,t),this.value=t;break}case"int":case"bool":{const t=s(e,Int32Array);if(n(null!==(i=this.value)&&void 0!==i?i:new Int32Array(0),t))return;this.state.gl[this.typeDef.setter](this.location,t),this.value=t;break}case"uint":{const t=s(e,Uint32Array);if(n(null!==(o=this.value)&&void 0!==o?o:new Uint32Array(0),t))return;this.state.gl[this.typeDef.setter](this.location,t),this.value=t;break}case"mat":{const t=s(e,Float32Array);if(n(null!==(a=this.value)&&void 0!==a?a:new Float32Array(0),t))return;this.state.gl[this.typeDef.setter](this.location,!1,t),this.value=t;break}case"sampler2D":{const t=Array.isArray(e)?e.slice():[e];if(n(null!==(l=this.value)&&void 0!==l?l:[],t))return;this.state.gl[this.typeDef.setter](this.location,!1,t),this.value=t;break}}}}class o{constructor(t,e){this.state=null,this.program=null,this.uniforms=new Map,this.onContextLost=()=>{this.state&&(this.state.contextLost.unsubscribe(this.onContextLost),this.state=null),this.program=null},this.vertexShader=t,this.fragmentShader=e}ensure(t){if(this.program)return;const e=t.gl,r=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(r,this.vertexShader.trim()),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){const t=e.getShaderInfoLog(r);throw e.deleteShader(r),new Error("Cannot compile vertex shader: "+t)}const s=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(s,this.fragmentShader.trim()),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS)){const t=e.getShaderInfoLog(s);throw e.deleteShader(s),new Error("Cannot compile fragment shader: "+t)}const n=e.createProgram();if(e.attachShader(n,r),e.attachShader(n,s),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){const t=e.getProgramInfoLog(n);throw e.deleteProgram(n),new Error("Cannot link program: "+t)}this.uniforms.clear();const o=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<o;++r){const s=e.getActiveUniform(n,r),o=e.getUniformLocation(n,s.name);this.uniforms.set(s.name,new i(t,s,o))}this.program=n,this.state=t,t.contextLost.subscribe(this.onContextLost)}uniform(t,e,r){this.ensure(t);const s=this.uniforms.get(e);s&&s.set(this.program,r)}}},1552:(t,e,r)=>{"use strict";r.d(e,{x:()=>s});class s{constructor(t){this.state=null,this.texture=null,this.onContextLost=()=>{this.state&&(this.state.contextLost.unsubscribe(this.onContextLost),this.state=null),this.texture=null},this.data=t,this.width=t.width,this.height=t.height}static image(t){return new s(t)}static size(t,e){return new s({width:t,height:e})}ensure(t){if(this.texture)return;const e=t.gl,r=e.createTexture();t.bindTexture(0,r),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this.data instanceof HTMLElement?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.data):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.width,this.height,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),this.state=t,this.texture=r,t.contextLost.subscribe(this.onContextLost)}delete(){this.state&&(this.state.gl.deleteTexture(this.texture),this.state.contextLost.unsubscribe(this.onContextLost),this.state=null,this.texture=null)}}s.WHITE=(()=>{const t=document.createElement("canvas");t.width=16,t.height=16;const e=t.getContext("2d");return e.fillStyle="#ffffff",e.fillRect(0,0,16,16),new s(t)})()},2106:(t,e,r)=>{"use strict";r.d(e,{F:()=>s});class s{constructor(t,e=null){this.state=null,this.vertexArray=null,this.indexBuffer=null,this.onContextLost=()=>{this.state&&(this.state.contextLost.unsubscribe(this.onContextLost),this.state=null),this.vertexArray=null},this.attributes=t,this.indexBuffer=e}ensure(t){if(this.vertexArray)return;const e=t.gl,r=e.createVertexArray();t.bindVertexArray(r),this.indexBuffer&&(this.indexBuffer.ensure(t),t.bindBuffer(e[this.indexBuffer.binding],this.indexBuffer.buffer));for(const r of this.attributes){const{index:s,buffer:n,type:i,components:o,normalized:a=!1,stride:l=0,offset:h=0,integer:u=!1}=r;let c;switch(i){case"byte":c=e.UNSIGNED_BYTE;break;case"ushort":c=e.UNSIGNED_SHORT;break;case"uint":c=e.UNSIGNED_INT;break;case"float":c=e.FLOAT}n.ensure(t),t.bindBuffer(e[n.binding],n.buffer),u?e.vertexAttribIPointer(s,o,c,l,h):e.vertexAttribPointer(s,o,c,a,l,h),e.enableVertexAttribArray(s)}this.vertexArray=r,this.state=t,t.contextLost.subscribe(this.onContextLost)}bind(t){var e;this.ensure(t),t.bindVertexArray(this.vertexArray),null===(e=this.indexBuffer)||void 0===e||e.bind(t)}}},3010:(t,e,r)=>{"use strict";r.d(e,{Ib:()=>s,WT:()=>n});var s=1e-6,n="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},2526:(t,e,r)=>{"use strict";r.d(e,{Ue:()=>n,d9:()=>i,JG:()=>o,yR:()=>a,al:()=>l,t8:()=>h,U_:()=>u,Jp:()=>c,U1:()=>d,bA:()=>f,Iu:()=>_,vc:()=>m,I6:()=>p});var s=r(3010);function n(){var t=new s.WT(6);return s.WT!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function i(t){var e=new s.WT(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function a(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function l(t,e,r,n,i,o){var a=new s.WT(6);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a[4]=i,a[5]=o,a}function h(t,e,r,s,n,i,o){return t[0]=e,t[1]=r,t[2]=s,t[3]=n,t[4]=i,t[5]=o,t}function u(t,e){var r=e[0],s=e[1],n=e[2],i=e[3],o=e[4],a=e[5],l=r*i-s*n;return l?(l=1/l,t[0]=i*l,t[1]=-s*l,t[2]=-n*l,t[3]=r*l,t[4]=(n*a-i*o)*l,t[5]=(s*o-r*a)*l,t):null}function c(t,e,r){var s=e[0],n=e[1],i=e[2],o=e[3],a=e[4],l=e[5],h=r[0],u=r[1],c=r[2],d=r[3],f=r[4],_=r[5];return t[0]=s*h+i*u,t[1]=n*h+o*u,t[2]=s*c+i*d,t[3]=n*c+o*d,t[4]=s*f+i*_+a,t[5]=n*f+o*_+l,t}function d(t,e,r){var s=e[0],n=e[1],i=e[2],o=e[3],a=e[4],l=e[5],h=Math.sin(r),u=Math.cos(r);return t[0]=s*u+i*h,t[1]=n*u+o*h,t[2]=s*-h+i*u,t[3]=n*-h+o*u,t[4]=a,t[5]=l,t}function f(t,e,r){var s=e[0],n=e[1],i=e[2],o=e[3],a=e[4],l=e[5],h=r[0],u=r[1];return t[0]=s*h,t[1]=n*h,t[2]=i*u,t[3]=o*u,t[4]=a,t[5]=l,t}function _(t,e,r){var s=e[0],n=e[1],i=e[2],o=e[3],a=e[4],l=e[5],h=r[0],u=r[1];return t[0]=s,t[1]=n,t[2]=i,t[3]=o,t[4]=s*h+i*u+a,t[5]=n*h+o*u+l,t}function m(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function p(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}},5543:(t,e,r)=>{"use strict";r.d(e,{Ue:()=>n,al:()=>i,t8:()=>o,mD:()=>a,Fp:()=>l,iu:()=>h,U1:()=>u,dC:()=>c});var s=r(3010);function n(){var t=new s.WT(2);return s.WT!=Float32Array&&(t[0]=0,t[1]=0),t}function i(t,e){var r=new s.WT(2);return r[0]=t,r[1]=e,r}function o(t,e,r){return t[0]=e,t[1]=r,t}function a(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function l(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function h(t,e,r){var s=e[0],n=e[1];return t[0]=r[0]*s+r[2]*n+r[4],t[1]=r[1]*s+r[3]*n+r[5],t}function u(t,e,r,s){var n=e[0]-r[0],i=e[1]-r[1],o=Math.sin(s),a=Math.cos(s);return t[0]=n*a-i*o+r[0],t[1]=n*o+i*a+r[1],t}var c=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t};n()},4945:(t,e,r)=>{"use strict";r.d(e,{Ue:()=>n,d9:()=>i,al:()=>o,JG:()=>a,t8:()=>l,IH:()=>h,bA:()=>u,fS:()=>c,dC:()=>d});var s=r(3010);function n(){var t=new s.WT(4);return s.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function i(t){var e=new s.WT(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function o(t,e,r,n){var i=new s.WT(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function l(t,e,r,s,n){return t[0]=e,t[1]=r,t[2]=s,t[3]=n,t}function h(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function u(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function c(t,e){var r=t[0],n=t[1],i=t[2],o=t[3],a=e[0],l=e[1],h=e[2],u=e[3];return Math.abs(r-a)<=s.Ib*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-l)<=s.Ib*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-h)<=s.Ib*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-u)<=s.Ib*Math.max(1,Math.abs(o),Math.abs(u))}var d=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t};n()},2390:t=>{var e=function(t){"use strict";var e,r=Object.prototype,s=r.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function h(t,e,r,s){var n=e&&e.prototype instanceof p?e:p,i=Object.create(n.prototype),o=new F(s||[]);return i._invoke=function(t,e,r){var s=c;return function(n,i){if(s===f)throw new Error("Generator is already running");if(s===_){if("throw"===n)throw i;return L()}for(r.method=n,r.arg=i;;){var o=r.delegate;if(o){var a=R(o,r);if(a){if(a===m)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(s===c)throw s=_,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);s=f;var l=u(t,e,r);if("normal"===l.type){if(s=r.done?_:d,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(s=_,r.method="throw",r.arg=l.arg)}}}(t,r,o),i}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var c="suspendedStart",d="suspendedYield",f="executing",_="completed",m={};function p(){}function g(){}function b(){}var v={};v[i]=function(){return this};var y=Object.getPrototypeOf,x=y&&y(y(S([])));x&&x!==r&&s.call(x,i)&&(v=x);var T=b.prototype=p.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(n,i,o,a){var l=u(t[n],t,i);if("throw"!==l.type){var h=l.arg,c=h.value;return c&&"object"==typeof c&&s.call(c,"__await")?e.resolve(c.__await).then((function(t){r("next",t,o,a)}),(function(t){r("throw",t,o,a)})):e.resolve(c).then((function(t){h.value=t,o(h)}),(function(t){return r("throw",t,o,a)}))}a(l.arg)}var n;this._invoke=function(t,s){function i(){return new e((function(e,n){r(t,s,e,n)}))}return n=n?n.then(i,i):i()}}function R(t,r){var s=t.iterator[r.method];if(s===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,R(t,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var n=u(s,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,m;var i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function F(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function S(t){if(t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function r(){for(;++n<t.length;)if(s.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}return{next:L}}function L(){return{value:e,done:!0}}return g.prototype=T.constructor=b,b.constructor=g,g.displayName=l(b,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,a,"GeneratorFunction")),t.prototype=Object.create(T),t},t.awrap=function(t){return{__await:t}},E(w.prototype),w.prototype[o]=function(){return this},t.AsyncIterator=w,t.async=function(e,r,s,n,i){void 0===i&&(i=Promise);var o=new w(h(e,r,s,n),i);return t.isGeneratorFunction(r)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},E(T),l(T,a,"Generator"),T[i]=function(){return this},T.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var s=e.pop();if(s in t)return r.value=s,r.done=!1,r}return r.done=!0,r}},t.values=S,F.prototype={constructor:F,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var r in this)"t"===r.charAt(0)&&s.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(s,n){return a.type="throw",a.arg=t,r.next=s,n&&(r.method="next",r.arg=e),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var l=s.call(o,"catchLoc"),h=s.call(o,"finallyLoc");if(l&&h){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var s=r.completion;if("throw"===s.type){var n=s.arg;A(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,s){return this.delegate={iterator:S(t),resultName:r,nextLoc:s},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}}]);
//# sourceMappingURL=785.0b61ebc4.js.map